(this["webpackJsonpreact-web-audio-graph"]=this["webpackJsonpreact-web-audio-graph"]||[]).push([[0],{16:function(e,t,n){e.exports=n.p+"a0986bdee6ebf67ad863.worklet.js"},26:function(e,t,n){},30:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n(0),r=n.n(a),i=n(7),o=n.n(i),u=(n(26),n(4)),s=n(2),l=n(11),d=n(5),f=n.n(d),j=n(10),m=Object(a.createContext)(null);var b=n(16),h=n.n(b);var v=function(e){var t=e.children,n=Object(a.useState)(!1),r=Object(u.a)(n,2),i=r[0],o=r[1],s=Object(a.useMemo)((function(){try{return window.AudioContext||(window.AudioContext=window.webkitAudioContext),new window.AudioContext}catch(e){}}),[]);Object(a.useEffect)((function(){var e=function(){var e=Object(j.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.audioWorklet.addModule(h.a);case 2:o(!0);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();s&&e(s)}),[s]);var l=Object(a.useCallback)((function(){"suspended"===(null===s||void 0===s?void 0:s.state)&&s.resume()}),[s]);return s?i?Object(c.jsx)("div",{onClick:l,children:Object(c.jsx)(m.Provider,{value:s,children:t})}):null:Object(c.jsx)("div",{children:"Sorry, but the Web Audio API is not supported by your browser."})},p=n(3),O=Object(a.createContext)(null);function x(){return Object(a.useContext)(O)}var g=n(37);var y=function(e){var t=e.children,n=r.a.useState(null),i=Object(u.a)(n,2),o=i[0],s=i[1],l=r.a.useState(),d=Object(u.a)(l,2),f=d[0],j=d[1],m=Object(a.useRef)(),b=Object(g.a)(m.current,f,{placement:"bottom-start"}),h=b.styles,v=b.attributes,x=Object(a.useMemo)((function(){return{getRect:function(){return null==m.current?{top:0,left:0,right:0,bottom:0,width:0,height:0}:m.current.getBoundingClientRect()},hide:function(){s(null)},show:function(e){s(e)},setRect:function(e){m.current={getBoundingClientRect:function(){return e}}},setPopperElement:j}}),[]);return Object(c.jsxs)(O.Provider,{value:x,children:[t,Object(c.jsx)("div",Object(p.a)(Object(p.a)({ref:function(e){return e&&j(e)},style:h.popper},v.popper),{},{children:o}))]})},N=n(13),C=n(38);function k(e){var t,n,c,a,r,i,o,u;A(e)?(null===(t=e.input)||void 0===t||null===(n=t.stop)||void 0===n||n.call(t),null===(c=e.output)||void 0===c||null===(a=c.stop)||void 0===a||a.call(c),null===(r=e.input)||void 0===r||r.disconnect(),null===(i=e.output)||void 0===i||i.disconnect()):(null===(o=(u=e).stop)||void 0===o||o.call(u),e.disconnect())}var w=function(e){var t=e.children,n=Object(a.useRef)({}),r=Object(a.useMemo)((function(){return{addNode:function(e,t){n.current[e]=t},getNode:function(e){return n.current[e]},nodes:n.current,removeNode:function(e){k(n.current[e]),delete n.current[e]}}}),[]);return Object(c.jsx)("div",{children:Object(c.jsx)(S.Provider,{value:r,children:t})})};function E(e){var t,n;return+(null!==(t=null===(n=e.match(/-(\d+)$/))||void 0===n?void 0:n[1])&&void 0!==t?t:0)}function T(e,t){if(!e.source||!e.target||!e.sourceHandle||!e.targetHandle)throw new Error("Invalid connection");var n=e.targetHandle.startsWith("input"),c=e.sourceHandle.startsWith("output"),a=t(e.source),r=t(e.target);if(A(a)&&c){if(!a.output)throw new Error("Invalid connection");a=a.output}if(A(r)&&n){if(!r.input)throw new Error("Invalid connection");r=r.input}if(!a||!r)throw new Error("Invalid connection");return{inputIndex:n?E(e.targetHandle):void 0,outputIndex:E(e.sourceHandle),source:c?a:a[e.sourceHandle],target:n?r:r[e.targetHandle]}}function M(e,t){try{var n=T(e,t),c=n.inputIndex,a=n.outputIndex,r=n.source,i=n.target;null!=c?r.connect(i,a,c):r.connect(i,a)}catch(o){console.error(o)}}function _(e,t){try{var n=T(e,t),c=n.inputIndex,a=n.outputIndex,r=n.source,i=n.target;null!=c?r.disconnect(i,a,c):r.disconnect(i,a)}catch(o){console.error(o)}}function A(e){return e&&"input"in e&&"output"in e}var S=Object(a.createContext)(null);function R(){return Object(a.useContext)(S)}function D(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],c=Object(a.useContext)(m),r=R(),i=r.addNode,o=r.getNode,u=r.removeNode,l=Object(s.k)((function(e){return e.edges})),d=Object(a.useMemo)((function(){return t(c)}),n);return Object(a.useEffect)((function(){i(e,d);var t=l.filter((function(t){return t.source===e||t.target===e}));return t.forEach((function(e){return M(e,o)})),function(){t.forEach((function(e){return _(e,o)})),u(e)}}),[i,o,d,e,u]),d}var F=n(18);function q(e,t){var n=Object(a.useRef)(),c=Object(a.useRef)(),r=null===t||void 0===t?void 0:t.maxFPS,i=Object(a.useCallback)((function(t){if(null!=n.current){var a=t-n.current;(!r||a>1e3/r)&&(e(a),n.current=t)}else e(0),n.current=t;c.current=requestAnimationFrame(i)}),[e]);Object(a.useEffect)((function(){return c.current=requestAnimationFrame(i),function(){null!=c.current&&cancelAnimationFrame(c.current)}}),[i])}function P(e){var t=e.node,n=e.paused,r=e.type,i=Object(F.a)(e,["node","paused","type"]),o=Object(a.useRef)(new Uint8Array(t.frequencyBinCount)),u=Object(a.useRef)(null),s=Object(a.useCallback)((function(){var e=u.current,t=null===e||void 0===e?void 0:e.getContext("2d");e&&t&&(r===W.TimeDomain?function(e,t){var n=0,c=e.canvas.height,a=e.canvas.width,r=t.length,i=a/r;e.fillStyle="#001400",e.fillRect(0,0,a,256),e.lineWidth=2,e.strokeStyle="#00c800",e.beginPath(),e.moveTo(n,c-t[0]/128*c/2);for(var o=1;o<r;o++){var u=t[o]/128*c/2;e.lineTo(n,c-u),n+=i}e.stroke()}(t,o.current):r===W.Frequency&&function(e,t){var n=0,c=e.canvas.height,a=e.canvas.width,r=t.length,i=a/r;e.fillStyle="#001400",e.fillRect(0,0,a,c),e.fillStyle="#00c800";for(var o=0;o<r;o++){var u=c*(t[o]/255),s=c-u;e.fillRect(n,s,i,u),n+=i}}(t,o.current))}),[r]),l=Object(a.useCallback)((function(){var e=t.frequencyBinCount,n=new Uint8Array(e);r===W.TimeDomain?t.getByteTimeDomainData(n):r===W.Frequency&&t.getByteFrequencyData(n),o.current=n}),[t,r]);return q(Object(a.useCallback)((function(){n||(l(),s())}),[s,l,n])),Object(c.jsx)("canvas",Object(p.a)({ref:u,style:{display:"block"}},i))}var I=r.a.memo(P),G=Object(a.createContext)(null);function L(){return Object(a.useContext)(G)}function B(e){var t=e.children,n=e.id,r=e.inputs,i=e.outputs,o=e.title,u=e.type,l=L(),d=l.elements,f=l.onChangeElementFactory,j=l.setElements,m=x(),b=d.find((function(e){return e.id===n})),h=Object(a.useMemo)((function(){return{background:"#".concat(n.substr(-6))}}),[n]),v=Object(a.useCallback)((function(){if(!b)throw new Error("Node does not exist - this should never happen");var e="".concat(u,"-").concat(Object(C.a)()),t=f(e),n={id:e,data:Object(p.a)(Object(p.a)({},b.data),{},{onChange:t}),type:b.type,position:{x:b.position.x+et,y:b.position.y+et}};j((function(e){return[].concat(Object(N.a)(e),[n])})),m.hide()}),[m,f,b,j,u]),O=Object(a.useCallback)((function(){m.hide()}),[m]),g=Object(a.useCallback)((function(e){e.preventDefault(),m.setRect({width:0,height:0,top:e.clientY,right:0,bottom:0,left:e.clientX}),m.show(Object(c.jsx)("ul",{className:"contextMenu",children:Object(c.jsx)("li",{onClick:v,children:"Clone"})}))}),[v,m]);return Object(c.jsxs)("div",{className:"customNode",title:n,onClick:O,onContextMenu:g,children:[Object(c.jsx)("div",{className:"customNode_header",children:null!==o&&void 0!==o?o:u}),Object(c.jsxs)("div",{className:"customNode_body",children:[r&&Object(c.jsx)("div",{className:"customNode_inputs",children:r.map((function(e){return Object(c.jsxs)("div",{className:"customNode_item",children:[Object(c.jsx)(s.c,{id:e,position:s.d.Left,style:h,type:"target"}),e]},e)}))}),i&&Object(c.jsx)("div",{className:"customNode_outputs",children:i.map((function(e){return Object(c.jsxs)("div",{className:"customNode_item",children:[Object(c.jsx)(s.c,{id:e,position:s.d.Right,style:h,type:"source"}),e]},e)}))})]}),t]})}var W,H=r.a.memo(B);function z(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.fftSizeExp,u=void 0===o?11:o,s=t.onChange,l=t.paused,d=void 0!==l&&l,f=t.type,j=void 0===f?W.TimeDomain:f,m=D(n,(function(e){return e.createAnalyser()}));return Object(a.useEffect)((function(){m.fftSize=Math.pow(2,u)}),[m,u]),Object(c.jsxs)(H,{id:n,inputs:["input","fftSize"],outputs:["output"],title:"Analyser: ".concat(j),type:i,children:[Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)(I,{type:j,node:m,paused:d,height:64,width:256})}),r&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsxs)("div",{className:"customNode_item",children:[Object(c.jsx)("input",{className:"nodrag",type:"range",max:"15",min:"5",onChange:function(e){return s({fftSizeExp:+e.target.value})},step:1,value:u}),Math.pow(2,u)]}),Object(c.jsxs)("div",{className:"customNode_item",style:{justifyContent:"space-between"},children:[Object(c.jsxs)("select",{onChange:function(e){return s({type:e.target.value})},value:j,children:[Object(c.jsx)("option",{value:W.Frequency,children:W.Frequency}),Object(c.jsx)("option",{value:W.TimeDomain,children:W.TimeDomain})]}),Object(c.jsxs)("label",{style:{alignItems:"center",display:"flex"},children:[Object(c.jsx)("input",{className:"nodrag",type:"checkbox",checked:d,onChange:function(e){return s({paused:!d})}}),"Paused"]})]})]})]})}!function(e){e.Frequency="Frequency",e.TimeDomain="Time Domain"}(W||(W={}));var Q,V=r.a.memo(z);function X(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.detune,u=void 0===o?0:o,s=t.gain,l=void 0===s?0:s,d=t.frequency,f=void 0===d?350:d,j=t.Q,m=void 0===j?1:j,b=t.onChange,h=t.type,v=void 0===h?Q.lowpass:h,p=Object(a.useRef)(null),O=D(n,(function(e){return e.createBiquadFilter()}));Object(a.useEffect)((function(){O.detune.value=u}),[O,u]),Object(a.useEffect)((function(){O.frequency.value=f}),[O,f]),Object(a.useEffect)((function(){O.gain.value=l}),[O,l]),Object(a.useEffect)((function(){O.Q.value=m}),[O,m]),Object(a.useEffect)((function(){O.type=v}),[O,v]),Object(a.useEffect)((function(){var e=p.current,t=null===e||void 0===e?void 0:e.getContext("2d");if(e&&t){var n=new Float32Array(O.context.sampleRate/200).map((function(e,t){return 100*t})),c=new Float32Array(n.length),a=new Float32Array(n.length);O.getFrequencyResponse(n,c,a),function(e,t,n){var c=0,a=e.canvas.height,r=e.canvas.width,i=t.length,o=r/i;e.fillStyle="#001400",e.fillRect(0,0,r,a),e.lineWidth=1,e.strokeStyle="#ffffff77",e.beginPath(),e.moveTo(n.frequency.value/(n.context.sampleRate/2)*r,0),e.lineTo(n.frequency.value/(n.context.sampleRate/2)*r,a),e.stroke(),e.closePath(),e.lineWidth=2,e.strokeStyle="#00c800",e.beginPath();for(var u=0;u<i;u++){var s=t[u]*a/2;e.lineTo(c,a-s),c+=o}e.stroke()}(t,c,O)}}),[O,u,l,f,m,r,v]);var x=[Q.lowshelf,Q.highshelf,Q.peaking].includes(v),g=[Q.lowpass,Q.highpass,Q.bandpass,Q.peaking,Q.notch,Q.allpass].includes(v);return Object(c.jsx)(H,{id:n,inputs:["input","detune","frequency","gain","Q"],outputs:["output"],title:"Filter: ".concat(v),type:i,children:r&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:-100,max:100,onChange:function(e){return b({detune:+e.target.value})},step:1,type:"range",value:u})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:10,max:O.context.sampleRate/2,onChange:function(e){return b({frequency:+e.target.value})},step:1,type:"range",value:f})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",disabled:!x,min:-40,max:40,onChange:function(e){return b({gain:+e.target.value})},step:.1,type:"range",value:l})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",disabled:!g,min:1e-4,max:[Q.lowpass,Q.highpass].includes(v)?10:1e3,onChange:function(e){return b({Q:+e.target.value})},step:[Q.lowpass,Q.highpass].includes(v)?.1:10,type:"range",value:m})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("select",{onChange:function(e){return b({type:e.target.value})},value:v,children:Object.values(Q).map((function(e){return Object(c.jsx)("option",{value:e,children:e},e)}))})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("canvas",{ref:p,height:64,width:256})})]})})}!function(e){e.lowpass="lowpass",e.highpass="highpass",e.bandpass="bandpass",e.lowshelf="lowshelf",e.highshelf="highshelf",e.peaking="peaking",e.notch="notch",e.allpass="allpass"}(Q||(Q={}));var J=r.a.memo(X),K={2:"Stereo",4:"Quad",6:"5.1"};function U(e){var t=e.data,n=e.id,a=e.selected,r=e.type,i=t.inputs,o=void 0===i?2:i,u=t.onChange,s=D(n,(function(e){return e.createChannelMerger(o)}),[o]);return Object(c.jsx)(H,{id:n,inputs:Array(s.numberOfInputs).fill(0).map((function(e,t){return"input-".concat(t)})),outputs:["output"],type:r,children:a&&Object(c.jsx)("div",{className:"customNode_editor",children:Object(c.jsx)("div",{className:"customNode_item",style:{alignItems:"flex-start",flexDirection:"column"},children:Object.keys(K).map((function(e){return Object(c.jsxs)("label",{children:[Object(c.jsx)("input",{checked:o===+e,className:"nodrag",onChange:function(e){return u({inputs:+e.target.value})},type:"radio",value:+e})," ",K[e]]},e)}))})})})}var Y=r.a.memo(U);function Z(e){var t=e.data,n=e.id,a=e.selected,r=e.type,i=t.onChange,o=t.outputs,u=void 0===o?2:o,s=D(n,(function(e){return e.createChannelSplitter(u)}),[u]);return Object(c.jsx)(H,{id:n,inputs:["input"],outputs:Array(s.numberOfOutputs).fill(0).map((function(e,t){return"output-".concat(t)})),type:r,children:a&&Object(c.jsx)("div",{className:"customNode_editor",children:Object(c.jsx)("div",{className:"customNode_item",style:{alignItems:"flex-start",flexDirection:"column"},children:Object.keys(K).map((function(e){return Object(c.jsxs)("label",{children:[Object(c.jsx)("input",{checked:u===+e,className:"nodrag",onChange:function(e){return i({outputs:+e.target.value})},type:"radio",value:+e})," ",K[e]]},e)}))})})})}var $=r.a.memo(Z);function ee(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.offset,u=void 0===o?1:o,s=t.onChange,l=D(n,(function(e){return e.createConstantSource()}));return Object(a.useEffect)((function(){return l.start(),function(){return l.stop()}}),[l]),Object(a.useEffect)((function(){return l.offset.value=u}),[l,u]),Object(c.jsx)(H,{id:n,outputs:["output"],title:"Constant: ".concat(u),type:i,children:r&&Object(c.jsx)("div",{className:"customNode_editor",children:Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"number",onChange:function(e){return s({offset:+e.target.value})},style:{width:"100%"},value:u})})})})}var te=r.a.memo(ee);function ne(e){return Math.max(.001,Math.min(179.999,e))}function ce(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.delayTime,u=void 0===o?1:o,s=t.maxDelayTime,l=void 0===s?1:s,d=t.onChange,f=D(n,(function(e){return e.createDelay(ne(l))}),[l]);return Object(a.useEffect)((function(){f.delayTime.value=u}),[f,u]),Object(c.jsx)(H,{id:n,inputs:["input","delayTime"],outputs:["output"],title:"Delay: ".concat(u," s"),type:i,children:r&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",max:f.delayTime.maxValue,min:f.delayTime.minValue,step:ne(l)/10,onChange:function(e){return d({delayTime:+e.target.value})},type:"range",value:u})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",onChange:function(e){return d({maxDelayTime:+e.target.value})},max:0,min:180,type:"number",value:ne(l)})})]})})}var ae=r.a.memo(ce);function re(e){var t=e.data,n=e.id,a=e.selected,r=e.type,i=t.delayTime,o=void 0===i?.2:i,u=t.feedback,s=void 0===u?.7:u,l=t.mix,d=void 0===l?.5:l,f=t.onChange;return D(n,(function(e){var t=e.createGain(),n=e.createGain(),c=e.createGain(),a=e.createGain(),r=e.createDelay(1);r.delayTime.value=o;var i=e.createGain();return i.gain.setTargetAtTime(s,i.context.currentTime,.015),c.gain.setTargetAtTime(Math.cos(.5*d*Math.PI),c.context.currentTime,.015),a.gain.setTargetAtTime(Math.cos(.5*(1-d)*Math.PI),a.context.currentTime,.015),t.connect(c),c.connect(n),t.connect(r),r.connect(a),a.connect(n),a.connect(i),i.connect(r),{input:t,output:n}}),[o,s,d]),Object(c.jsx)(H,{id:n,inputs:["input"],outputs:["output"],title:"DelayEffect",type:r,children:a&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"1",min:"0",step:"0.01",onChange:function(e){return f({mix:+e.target.value})},value:d})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"1",min:"0",step:"0.01",onChange:function(e){return f({delayTime:+e.target.value})},value:o})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"1",min:"0",step:"0.01",onChange:function(e){return f({feedback:+e.target.value})},value:s})})]})})}var ie=r.a.memo(re);function oe(e){var t=e.id,n=e.type;return D(t,(function(e){return e.destination})),Object(c.jsx)(H,{id:t,inputs:["input"],type:n})}var ue=r.a.memo(oe);function se(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.attack,u=void 0===o?.003:o,s=t.knee,l=void 0===s?30:s,d=t.onChange,f=t.ratio,j=void 0===f?12:f,m=t.release,b=void 0===m?.25:m,h=t.threshold,v=void 0===h?-24:h,p=D(n,(function(e){return e.createDynamicsCompressor()}));return Object(a.useEffect)((function(){p.threshold.value=v}),[p,v]),Object(a.useEffect)((function(){p.knee.value=l}),[p,l]),Object(a.useEffect)((function(){p.ratio.value=j}),[p,j]),Object(a.useEffect)((function(){p.attack.value=u}),[p,u]),Object(a.useEffect)((function(){p.release.value=b}),[p,b]),Object(c.jsx)(H,{id:n,inputs:["input","threshold","knee","ratio","attack","release"],outputs:["output"],type:i,children:r&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"0",min:"-100",step:"1",onChange:function(e){return d({threshold:+e.target.value})},value:v})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"40",min:"0",step:"1",onChange:function(e){return d({knee:+e.target.value})},value:l})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"20",min:"1",step:"1",onChange:function(e){return d({ratio:+e.target.value})},value:j})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"1",min:"0",step:"0.001",onChange:function(e){return d({attack:+e.target.value})},value:u})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"1",min:"0",step:"0.001",onChange:function(e){return d({release:+e.target.value})},value:b})})]})})}var le=r.a.memo(se);function de(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.attackTime,u=void 0===o?.2:o,s=t.decayTime,l=void 0===s?.1:s,d=t.onChange,f=t.releaseTime,j=void 0===f?.6:f,m=t.sustainLevel,b=void 0===m?.7:m,h=t.sustainOn,v=void 0===h||h,p=Object(a.useRef)(null),O=Object(a.useRef)(Number.MAX_SAFE_INTEGER),x=Object(a.useRef)(Number.MAX_SAFE_INTEGER),g=D(n,(function(e){var t=e.createGain();return{gate:new AudioWorkletNode(e,"gate-processor"),input:t,output:t}}));Object(a.useEffect)((function(){g.output.gain.setTargetAtTime(0,g.output.context.currentTime,.015)}),[g]);var y=Object(a.useCallback)((function(){var e=g.output.context.currentTime;O.current=e,g.output.gain.cancelScheduledValues(e),g.output.gain.setValueAtTime(0,e),g.output.gain.linearRampToValueAtTime(1,e+u),g.output.gain.linearRampToValueAtTime(b,e+u+l),v||g.output.gain.linearRampToValueAtTime(0,e+u+l+j)}),[g,u,l,j,b,v]),N=Object(a.useCallback)((function(){var e=g.output.context.currentTime;x.current=e,g.output.gain.cancelScheduledValues(e),g.output.gain.setValueAtTime(g.output.gain.value,e);var t=v?0:Math.max(0,x.current-O.current-(u+l));g.output.gain.linearRampToValueAtTime(0,e+j-t)}),[g,u,l,j,v]),C=Object(a.useCallback)((function(e){var t=e.data;"gateOn"===t?y():"gateOff"===t&&N()}),[N,y]);return Object(a.useEffect)((function(){g.gate.port.onmessage=C}),[g,C]),q(Object(a.useCallback)((function(){var e=p.current,t=null===e||void 0===e?void 0:e.getContext("2d");e&&t&&function(e,t,n){var c=t.attackTime,a=t.decayTime,r=t.sustainLevel,i=t.sustainOn,o=t.releaseTime,u=n.currentTime,s=n.gain,l=n.keyOffEventTime,d=n.keyOnEventTime,f=e.canvas.height,j=e.canvas.width,m=i?(c+a+o)/9:0,b=j/(c+a+o+m);e.fillStyle="#001400",e.fillRect(0,0,j,f),e.lineWidth=2,e.strokeStyle="#00c800",e.beginPath(),e.moveTo(0,f),e.lineTo(c*b,0),e.lineTo((c+a)*b,(1-r)*f),e.lineTo((c+a+m)*b,(1-r)*f),e.lineTo((c+a+m+o)*b,f),e.stroke(),e.closePath();var h=Math.min(u-d,c+a+m+(i?0:o))*b;i&&l>d&&(h=(c+a+m+Math.min(u-l,o))*b),e.beginPath(),e.fillStyle="#ffff00",e.moveTo(h,(1-s)*f),e.arc(h,(1-s)*f,3,0,2*Math.PI),e.fill()}(t,{attackTime:u,decayTime:l,releaseTime:j,sustainLevel:b,sustainOn:v},{currentTime:g.output.context.currentTime,gain:g.output.gain.value,keyOffEventTime:x.current,keyOnEventTime:O.current})}),[g,u,l,j,b,v])),Object(c.jsx)(H,{id:n,inputs:["input","gate"],outputs:["output"],type:i,children:r&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("canvas",{ref:p,height:64,width:256})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsxs)("label",{style:{alignItems:"center",display:"flex"},children:[Object(c.jsx)("input",{className:"nodrag",type:"checkbox",checked:v,onChange:function(e){return d({sustainOn:!v})}}),"sustain on"]})}),Object(c.jsxs)("div",{className:"customNode_item",style:{width:276},children:[Object(c.jsx)("input",{className:"nodrag",min:0,onChange:function(e){return d({attackTime:+e.target.value})},step:.05,type:"number",style:{width:"25%"},value:u}),Object(c.jsx)("input",{className:"nodrag",min:0,onChange:function(e){return d({decayTime:+e.target.value})},type:"number",step:.05,style:{width:"25%"},value:l}),Object(c.jsx)("input",{className:"nodrag",max:1,min:0,onChange:function(e){return d({sustainLevel:+e.target.value})},step:.01,type:"number",style:{width:"25%"},value:b}),Object(c.jsx)("input",{className:"nodrag",min:0,onChange:function(e){return d({releaseTime:+e.target.value})},step:.05,type:"number",style:{width:"25%"},value:j})]})]})})}var fe=r.a.memo(de);function je(e){var t=e.addNode;return Object(c.jsxs)("ul",{className:"contextMenu",children:[Object(c.jsx)("li",{onClick:function(){return t("Analyser")},children:"Add Analyser"}),Object(c.jsx)("li",{onClick:function(){return t("BiquadFilter")},children:"Add Biquad Filter"}),Object(c.jsx)("li",{onClick:function(){return t("ChannelMerger")},children:"Add Channel Merger"}),Object(c.jsx)("li",{onClick:function(){return t("ChannelSplitter")},children:"Add Channel Splitter"}),Object(c.jsx)("li",{onClick:function(){return t("ConstantSource")},children:"Add Constant Source"}),Object(c.jsx)("li",{onClick:function(){return t("Delay")},children:"Add Delay"}),Object(c.jsx)("li",{onClick:function(){return t("Destination")},children:"Add Destination"}),Object(c.jsx)("li",{onClick:function(){return t("DynamicsCompressor")},children:"Add Dynamics Compressor"}),Object(c.jsx)("li",{onClick:function(){return t("Envelope")},children:"Add Envelope"}),Object(c.jsx)("li",{onClick:function(){return t("DelayEffect")},children:"Add DelayEffect"}),Object(c.jsx)("li",{onClick:function(){return t("Gain")},children:"Add Gain"}),Object(c.jsx)("li",{onClick:function(){return t("Gate")},children:"Add Gate"}),Object(c.jsx)("li",{onClick:function(){return t("Keyboard")},children:"Add Keyboard"}),Object(c.jsx)("li",{onClick:function(){return t("Metronome")},children:"Add Metronome"}),Object(c.jsx)("li",{onClick:function(){return t("Noise")},children:"Add Noise"}),Object(c.jsx)("li",{onClick:function(){return t("Oscillator")},children:"Add Oscillator"}),Object(c.jsx)("li",{onClick:function(){return t("OscillatorNote")},children:"Add Oscillator Note"}),Object(c.jsx)("li",{onClick:function(){return t("StereoPanner")},children:"Add Stereo Panner"}),Object(c.jsx)("li",{onClick:function(){return t("WaveShaper")},children:"Add Wave Shaper"})]})}var me,be=r.a.memo(je);!function(e){e.Linear="Linear",e.Log="Log"}(me||(me={}));var he=function(e){var t=e.onChange,n=e.type,r=.001,i=e.value;n===me.Log&&(r=9/(1/r),i=function(e){return(Math.pow(10,e)-1)/9}(i));var o=Object(a.useCallback)((function(e){var c=+e.target.value;n===me.Log&&(c=function(e){return Math.log10(1+9*e)}(c)),t(c)}),[t,n]);return Object(c.jsx)("input",{className:"nodrag",type:"range",max:1,min:0,step:r,onChange:o,value:i})};function ve(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.gain,u=void 0===o?1:o,s=t.onChange,l=t.type,d=void 0===l?me.Log:l,f=D(n,(function(e){return e.createGain()}));return Object(a.useEffect)((function(){f.gain.setTargetAtTime(u,f.context.currentTime,.015)}),[f,u]),Object(c.jsx)(H,{id:n,inputs:["input","gain"],outputs:["output"],title:"Gain: ".concat(u.toFixed(3)),type:i,children:r&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)(he,{onChange:function(e){return s({gain:e})},type:d,value:u})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsxs)("select",{onChange:function(e){return s({type:e.target.value})},value:d,children:[Object(c.jsx)("option",{value:me.Linear,children:me.Linear}),Object(c.jsx)("option",{value:me.Log,children:me.Log})]})})]})})}var pe=r.a.memo(ve);function Oe(e){var t=e.data,n=e.id,r=e.type,i=t.isOn,o=void 0!==i&&i,u=t.onChange,s=D(n,(function(e){return e.createConstantSource()}));Object(a.useEffect)((function(){return s.start(),function(){return s.stop()}}),[s]),Object(a.useEffect)((function(){s.offset.setTargetAtTime(o?1:0,s.context.currentTime,.015)}),[s,o]);var l=Object(a.useCallback)((function(e){"repeat"in e&&e.repeat||u({isOn:!0})}),[u]),d=Object(a.useCallback)((function(){return u({isOn:!1})}),[u]);return Object(c.jsx)(H,{id:n,outputs:["output"],title:"Gate",type:r,children:Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsxs)("button",{onMouseDown:l,onMouseUp:d,onKeyDown:l,onKeyUp:d,children:["trigger ",o?"off":"on"]})})})}var xe,ge,ye=r.a.memo(Oe),Ne=["C","C\u266f","D","D\u266f","E","F","F\u266f","G","G\u266f","A","A\u266f","B"];function Ce(e){if(e<0||e>11)throw new RangeError("Octave must be between 0 and 11, is ".concat(e))}function ke(e,t){!function(e){if(e<0||e>10)throw new RangeError("Octave must be between 0 and 10, is ".concat(e))}(e),Ce(t);return 16.3516*Math.pow(2,e+t/12)}function we(e){return Ce(e),Ne[e]}!function(e){e[e.Whole="\ueca2"]="Whole",e[e.Half="\ueca3"]="Half",e[e.Quarter="\ueca5"]="Quarter",e[e.Sixteenth="\ueca9"]="Sixteenth",e[e.Eight="\ueca7"]="Eight"}(xe||(xe={})),function(e){e[e.Whole=1]="Whole",e[e.Half=2]="Half",e[e.Quarter=4]="Quarter",e[e.Eight=8]="Eight",e[e.Sixteenth=16]="Sixteenth"}(ge||(ge={}));n(30);var Ee="key key-black",Te="key key-white";function Me(e){var t=e.data,n=e.id,r=e.type,i=t.octave,o=void 0===i?2:i,u=t.onChange,s=D(n,(function(e){var t=e.createConstantSource();return{frequency:e.createConstantSource(),gate:t,input:void 0,output:void 0}}));Object(a.useEffect)((function(){return s.frequency.offset.value=0,s.frequency.start(),s.gate.offset.value=0,s.gate.start(),function(){s.gate.disconnect(),s.gate.stop(),s.frequency.disconnect(),s.frequency.stop()}}),[s]);var l=Object(a.useCallback)((function(e,t){var n=s.frequency.context,c=ke(e,t);s.frequency.offset.setTargetAtTime(c,n.currentTime,.015)}),[s]),d=Object(a.useCallback)((function(){s.gate.offset.value=1}),[s]),f=Object(a.useCallback)((function(){s.gate.offset.value=0}),[s]);return Object(c.jsxs)(H,{id:n,outputs:["frequency","gate"],title:"Keyboard",type:r,children:[Object(c.jsx)("div",{className:"customNode_item nodrag",children:Object(c.jsxs)("div",{className:"keyboard",onMouseDown:d,onMouseLeave:f,onMouseUp:f,children:[Object(c.jsx)("button",{className:Te,onMouseEnter:function(){return l(o-1,9)},children:"1"}),Object(c.jsx)("button",{className:Ee,onMouseEnter:function(){return l(o-1,10)},children:"2"}),Object(c.jsx)("button",{className:Te,onMouseEnter:function(){return l(o-1,11)},children:"3"}),Object(c.jsx)("button",{className:Te,onMouseEnter:function(){return l(o,0)},children:"4"}),Object(c.jsx)("button",{className:Ee,onMouseEnter:function(){return l(o,1)},children:"5"}),Object(c.jsx)("button",{className:Te,onMouseEnter:function(){return l(o,2)},children:"6"}),Object(c.jsx)("button",{className:Ee,onMouseEnter:function(){return l(o,3)},children:"7"}),Object(c.jsx)("button",{className:Te,onMouseEnter:function(){return l(o,4)},children:"8"}),Object(c.jsx)("button",{className:Te,onMouseEnter:function(){return l(o,5)},children:"9"}),Object(c.jsx)("button",{className:Ee,onMouseEnter:function(){return l(o,6)},children:"10"}),Object(c.jsx)("button",{className:Te,onMouseEnter:function(){return l(o,7)},children:"11"}),Object(c.jsx)("button",{className:Ee,onMouseEnter:function(){return l(o,8)},children:"12"}),Object(c.jsx)("button",{className:Te,onMouseEnter:function(){return l(o,9)},children:"13"}),Object(c.jsx)("button",{className:Ee,onMouseEnter:function(){return l(o,10)},children:"14"}),Object(c.jsx)("button",{className:Te,onMouseEnter:function(){return l(o,11)},children:"15"}),Object(c.jsx)("button",{className:Te,onMouseEnter:function(){return l(o+1,0)},children:"16"})]})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:1,max:6,onChange:function(e){return u({octave:+e.target.value})},type:"number",value:o})})]})}var _e=r.a.memo(Me),Ae=n(12),Se=(n(31),{fontFamily:"Bravura",fontSize:20,height:32,lineHeight:2,padding:0,width:32});function Re(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.beatsPerMeasure,u=void 0===o?4:o,s=t.beatsPerMinute,l=void 0===s?120:s,d=t.notes,f=void 0===d?[ge.Quarter]:d,j=t.onChange,m=D(n,(function(e){var t,n=60/l,c=n*u,a=e.createBuffer(1,e.sampleRate*c,e.sampleRate),r=a.getChannelData(0),i=Object(Ae.a)(f);try{for(i.s();!(t=i.n()).done;)for(var o=t.value,s=n*ge.Quarter/o,d=e.sampleRate*s,j=880*o/ge.Quarter,m=u*o/ge.Quarter,b=0,h=1,v=0;v<m;v++)for(var p=0;p<d;p++){var O=0===v?1.33*j:j,x=p+Math.floor(v*d),g=1/f.length,y=Math.min(g,p/(.015*e.sampleRate));r[x]+=Math.sin(b)*h,b+=2*Math.PI*O/e.sampleRate,h=Math.max(y-p/d,0)}}catch(C){i.e(C)}finally{i.f()}var N=e.createBufferSource();return N.buffer=a,N.loop=!0,N.loopEnd=c,N}),[u,f.length,l]);Object(a.useEffect)((function(){return m.start(),function(){return m.stop()}}),[m]);var b=Object(a.useCallback)((function(e){return j({notes:f.includes(e)?f.filter((function(t){return t!==e})):f.concat(e)})}),[f,j]);return Object(c.jsx)(H,{id:n,outputs:["output"],title:"Metronome: ".concat(l," BPM"),type:i,children:r&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsxs)("div",{className:"customNode_item",children:[Object(c.jsx)("input",{className:"nodrag",max:208,min:40,onChange:function(e){return j({beatsPerMinute:+e.target.value})},type:"number",value:l}),Object(c.jsx)("input",{className:"nodrag",max:8,min:1,onChange:function(e){return j({beatsPerMeasure:+e.target.value})},type:"number",value:u})]}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("span",{className:"nodrag",style:{alignItems:"center",display:"flex",justifyContent:"space-between"},children:[ge.Whole,ge.Half,ge.Quarter,ge.Eight,ge.Sixteenth].map((function(e){return Object(c.jsx)("button",{onClick:function(){return b(e)},style:Object(p.a)(Object(p.a)({},Se),{},{color:f.includes(e)?"#0d0":"#d00"}),children:xe[ge[e]]},e)}))})})]})})}var De=r.a.memo(Re);function Fe(e){for(var t=e.length,n=e.getChannelData(0),c=0;c<t;c++)n[c]=2*Math.random()-1;return e}function qe(e){for(var t=e.length,n=e.getChannelData(0),c=0,a=0,r=0,i=0,o=0,u=0,s=0,l=0;l<t;l++){var d=2*Math.random()-1;c=.99886*c+.0555179*d,a=.99332*a+.0750759*d,r=.969*r+.153852*d,i=.8665*i+.3104856*d,o=.55*o+.5329522*d,u=-.7616*u-.016898*d,n[l]=c+a+r+i+o+u+s+.5362*d,n[l]*=.11,s=.115926*d}return e}function Pe(e){for(var t=e.length,n=e.getChannelData(0),c=0,a=0;a<t;a++){var r=2*Math.random()-1;n[a]=(c+.02*r)/1.02,c=n[a],n[a]*=3.5}return e}function Ie(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.onChange,u=t.type,s=void 0===u?"white":u,l=D(n,(function(e){var t=5*e.sampleRate,n=(0,{brown:Pe,pink:qe,white:Fe}[s])(e.createBuffer(1,t,e.sampleRate)),c=e.createBufferSource();return c.buffer=n,c.loop=!0,c}),[s]);return Object(a.useEffect)((function(){return l.start(),function(){return l.stop()}}),[l]),Object(c.jsx)(H,{id:n,outputs:["output"],title:"Noise: ".concat(s),type:i,children:r&&Object(c.jsx)("div",{className:"customNode_editor",children:Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsxs)("select",{onChange:function(e){return o({type:e.target.value})},value:s,children:[Object(c.jsx)("option",{value:"white",children:"white"}),Object(c.jsx)("option",{value:"pink",children:"pink"}),Object(c.jsx)("option",{value:"brown",children:"brown"})]})})})})}var Ge=r.a.memo(Ie);function Le(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.detune,u=void 0===o?0:o,s=t.frequency,l=void 0===s?440:s,d=t.onChange,f=t.type,j=void 0===f?"sine":f,m=D(n,(function(e){return e.createOscillator()}));return Object(a.useEffect)((function(){return m.start(),function(){return m.stop()}}),[m]),Object(a.useEffect)((function(){m.detune.value=null!==u&&void 0!==u?u:0}),[m,u]),Object(a.useEffect)((function(){m.frequency.value=null!==l&&void 0!==l?l:440}),[m,l]),Object(a.useEffect)((function(){m.type=null!==j&&void 0!==j?j:"sine"}),[m,j]),Object(c.jsx)(H,{id:n,inputs:["detune","frequency"],outputs:["output"],title:"".concat(l," Hz ").concat(j),type:i,children:r&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:-100,max:100,onChange:function(e){return d({detune:+e.target.value})},step:1,type:"number",value:u})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:0,max:2e4,onChange:function(e){return d({frequency:+e.target.value})},type:"number",value:l})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsxs)("select",{onChange:function(e){return d({type:e.target.value})},value:j,children:[Object(c.jsx)("option",{value:"sawtooth",children:"sawtooth"}),Object(c.jsx)("option",{value:"square",children:"square"}),Object(c.jsx)("option",{value:"sine",children:"sine"}),Object(c.jsx)("option",{value:"triangle",children:"triangle"})]})})]})})}var Be=r.a.memo(Le),We={display:"inline-block",textAlign:"center",width:7},He=Object(p.a)(Object(p.a)({},We),{},{verticalAlign:"sub"}),ze=Object(p.a)(Object(p.a)({},We),{},{transform:"translateX(-100%)",verticalAlign:"super"});function Qe(e){var t=e.octave,n=e.twelfth,a=we(n).split(""),r=Object(u.a)(a,2),i=r[0],o=r[1],s=ke(t,n);return Object(c.jsxs)("span",{children:[i,Object(c.jsx)("small",{style:He,children:t}),o&&Object(c.jsx)("small",{style:ze,children:o}),Object(c.jsxs)("small",{children:[" (",s.toFixed(2)," Hz)"]})]})}var Ve=r.a.memo(Qe);function Xe(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.detune,u=void 0===o?0:o,s=t.octave,l=void 0===s?4:s,d=t.onChange,f=t.twelfth,j=void 0===f?0:f,m=t.type,b=void 0===m?"sine":m,h=ke(l,j),v=D(n,(function(e){return e.createOscillator()}));return Object(a.useEffect)((function(){return v.start(),function(){return v.stop()}}),[v]),Object(a.useEffect)((function(){v.detune.value=null!==u&&void 0!==u?u:0}),[v,u]),Object(a.useEffect)((function(){v.frequency.value=h}),[v,h]),Object(a.useEffect)((function(){v.type=null!==b&&void 0!==b?b:"sine"}),[v,b]),Object(c.jsx)(H,{id:n,inputs:["detune"],outputs:["output"],title:Object(c.jsx)(Ve,{octave:l,twelfth:j}),type:i,children:r&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:-100,max:100,onChange:function(e){return d({detune:+e.target.value})},step:1,style:{width:"100%"},type:"range",value:u})}),Object(c.jsxs)("div",{className:"customNode_item",children:[Object(c.jsx)("select",{onChange:function(e){return d({twelfth:+e.target.value})},style:{width:"50%"},value:j,children:Array(12).fill(0).map((function(e,t){return Object(c.jsx)("option",{value:t,children:we(t)},t)}))}),Object(c.jsx)("select",{onChange:function(e){return d({octave:+e.target.value})},style:{width:"50%"},value:l,children:Array(11).fill(0).map((function(e,t){return Object(c.jsx)("option",{value:t,children:t},t)}))})]}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsxs)("select",{onChange:function(e){return d({type:e.target.value})},style:{width:"100%"},value:b,children:[Object(c.jsx)("option",{value:"sawtooth",children:"sawtooth"}),Object(c.jsx)("option",{value:"square",children:"square"}),Object(c.jsx)("option",{value:"sine",children:"sine"}),Object(c.jsx)("option",{value:"triangle",children:"triangle"})]})})]})})}function Je(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.pan,u=void 0===o?0:o,s=t.onChange,l=D(n,(function(e){return e.createStereoPanner()}));return Object(a.useEffect)((function(){l.pan.value=u}),[l,u]),Object(c.jsx)(H,{id:n,inputs:["input","pan"],outputs:["output"],title:"Stereo: ".concat(Math.abs(100*u).toFixed(0),"% ").concat(u>0?"Right":u<0?"Left":""),type:i,children:r&&Object(c.jsx)("div",{className:"customNode_editor",children:Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"1",min:"-1",step:"0.01",onChange:function(e){return s({pan:+e.target.value})},value:u})})})})}function Ke(e){var t,n=e.data,r=e.id,i=e.selected,o=e.type,s=n.onChange,l=n.oversample,d=Object(a.useState)(null!==(t=n.curveFn)&&void 0!==t?t:"const k = 50;\nconst samples = curve.length;\nconst deg = Math.PI / 180;\nfor (let i = 0; i < samples; i++) {\n  const x = (i * 2) / samples - 1;\n  curve[i] = ((3 + k) * x * 20 * deg) / (Math.PI + k * Math.abs(x));\n}\nreturn curve;"),f=Object(u.a)(d,2),j=f[0],b=f[1],h=Object(a.useState)(j),v=Object(u.a)(h,2),p=v[0],O=v[1],x=Object(a.useContext)(m),g=D(r,(function(){return x.createWaveShaper()})),y=Object(a.useMemo)((function(){var e=new Float32Array(x.sampleRate);return new Function("curve",p)(e)}),[x.sampleRate,p]);Object(a.useEffect)((function(){g.curve=y}),[g,y]),Object(a.useEffect)((function(){g.oversample=l}),[g,l]);var N=Object(a.useCallback)((function(){try{new Function("curve",j)(new Float32Array(x.sampleRate)),O(j),s({curveFn:j})}catch(e){console.error(e)}}),[x.sampleRate,j,s]);return Object(c.jsx)(H,{id:r,inputs:["input"],outputs:["output"],type:o,children:i&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsxs)("div",{className:"customNode_item",style:{flexWrap:"wrap"},children:[Object(c.jsx)("textarea",{className:"nodrag",onChange:function(e){return b(e.target.value)},rows:8,style:{width:"100%"},value:j}),Object(c.jsx)("button",{onClick:N,children:"save"})]}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsxs)("select",{onChange:function(e){return s({oversample:e.target.value})},value:l,children:[Object(c.jsx)("option",{value:"none",children:"none"}),Object(c.jsx)("option",{value:"2x",children:"2x"}),Object(c.jsx)("option",{value:"4x",children:"4x"})]})})]})})}var Ue={Analyser:V,BiquadFilter:J,ChannelMerger:Y,ChannelSplitter:$,ConstantSource:te,Delay:ae,DelayEffect:ie,Destination:ue,DynamicsCompressor:le,Envelope:fe,Gain:pe,Gate:ye,Keyboard:_e,Metronome:De,Noise:Ge,Oscillator:Be,OscillatorNote:r.a.memo(Xe),StereoPanner:r.a.memo(Je),WaveShaper:r.a.memo(Ke)};function Ye(e){return e.source?Object.assign({},e,{style:{stroke:"#".concat(e.source.substr(-6))}}):e}function Ze(e,t){return $e.apply(this,arguments)}function $e(){return($e=Object(j.a)(f.a.mark((function e(t,n){var c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=t.filter(s.h).reduce((function(e,t){return e[t.source]=!0,e[t.target]=!0,e}),{});case 1:if(!Object.keys(c).length){e.next=7;break}return Object.keys(n).forEach((function(e){delete c[e]})),e.next=5,new Promise((function(e){return setTimeout(e,0)}));case 5:e.next=1;break;case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var et=10;function tt(e){return Math.floor(e/et)*et}function nt(){var e=L(),t=e.elements,n=e.onChangeElementFactory,r=e.setElements,i=e.setTransform,o=e.transform,u=x(),d=R().nodes,m=function(){var e=R().getNode;return Object(a.useCallback)((function(t){return M(t,e)}),[e])}(),b=function(){var e=R().getNode;return Object(a.useCallback)((function(t){return _(t,e)}),[e])}(),h=function(){var e=R().getNode;return Object(a.useCallback)((function(t){return k(e(t))}),[e])}(),v=Object(a.useCallback)(function(){var e=Object(j.a)(f.a.mark((function e(c){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.setTransform(o),r(Object(l.a)((function(e){e.filter(s.i).forEach((function(e){e.data.onChange=n(e.id)}))}))),e.next=4,Ze(t,d);case 4:t.filter(s.h).forEach((function(e){return m(e)}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),p=Object(a.useCallback)((function(e){i(e)}),[i]),O=Object(a.useCallback)((function(e){r((function(t){return Object(s.f)(Ye(e),t)})),m(e)}),[m,r]),g=Object(a.useCallback)((function(e){e.filter(s.h).forEach((function(e){return b(e)})),e.filter(s.i).forEach((function(e){return h(e.id)})),r((function(t){return Object(s.j)(e,t)}))}),[b,h,r]),y=Object(a.useCallback)((function(e,t){b(e),r((function(t){return Object(s.j)([e],t)})),r((function(e){return Object(s.f)(Ye(t),e)})),m(t)}),[b,m,r]),w=Object(a.useCallback)((function(e,t){r(Object(l.a)((function(e){var n=e.filter(s.i).find((function(e){return e.id===t.id}));n&&(n.position={x:tt(t.position.x),y:tt(t.position.y)})})))}),[r]),E=Object(a.useCallback)((function(e){var t="".concat(e,"-").concat(Object(C.a)()),c={id:t,data:{onChange:n(t)},type:e,position:{x:tt((u.getRect().left-o.x)/o.zoom),y:tt((u.getRect().top-o.y)/o.zoom)}};r((function(e){return[].concat(Object(N.a)(e),[c])})),u.hide()}),[u,n,r,o]),T=Object(a.useCallback)((function(){u.hide()}),[u]),A=Object(a.useCallback)((function(e){e.preventDefault(),u.setRect({width:0,height:0,top:e.clientY,right:0,bottom:0,left:e.clientX}),u.show(Object(c.jsx)(be,{addNode:E}))}),[E,u]);return Object(c.jsx)(c.Fragment,{children:Object(c.jsxs)(s.g,{defaultPosition:[o.x,o.y],defaultZoom:o.zoom,elements:t,nodeTypes:Ue,onConnect:O,onEdgeUpdate:y,onElementsRemove:g,onLoad:v,onMoveEnd:p,onNodeDragStop:w,onPaneClick:T,onPaneContextMenu:A,onlyRenderVisibleElements:!1,snapToGrid:!0,snapGrid:[et,et],style:{zIndex:0},children:[Object(c.jsx)(s.a,{gap:et}),Object(c.jsx)(s.b,{})]})})}var ct=r.a.memo(nt),at={fontSize:12,height:"100%",resize:"none",width:"100%"},rt={display:"flex",position:"absolute",right:"100%",top:-10,transform:"rotate(-90deg)",transformOrigin:"bottom right"},it=function(){return{id:Object(C.a)(),elements:[],transform:{x:0,y:0,zoom:1}}};var ot=function(){var e=L(),t=e.elements,n=e.id,r=e.setElements,i=e.setId,o=e.setTransform,s=e.transform,l=Object(a.useState)(!1),d=Object(u.a)(l,2),f=d[0],j=d[1],m=Object(a.useMemo)((function(){return function(e){return{height:"100%",padding:10,position:"absolute",right:0,top:0,transform:e?"translateX(0)":"translateX(100%)",transition:"transform 0.4s ease",width:400}}(f)}),[f]);Object(a.useEffect)((function(){var e=atob(window.location.hash.substr(1));try{var t=JSON.parse(e),n=t.elements,c=t.id,a=t.transform;r(n),i(null!==c&&void 0!==c?c:Object(C.a)()),o(a)}catch(u){console.error(u)}}),[r,i,o]),Object(a.useEffect)((function(){window.location.hash=btoa(JSON.stringify({elements:t.map((function(e){return Object(p.a)(Object(p.a)({},e),{},{__rf:void 0})})),id:n,transform:s}))}),[t,n,s]);var b=Object(a.useCallback)((function(e){try{var t=JSON.parse(e.target.value),n=t.elements,c=t.id,a=t.transform;r(n),i(null!==c&&void 0!==c?c:Object(C.a)()),o(a)}catch(e){console.error(e)}}),[r,i,o]),h=Object(a.useCallback)((function(){var e=it();r(e.elements),i(e.id),o(e.transform)}),[r,i,o]),v=Object(a.useCallback)((function(){return j((function(e){return!e}))}),[]);return Object(c.jsxs)("div",{style:m,children:[Object(c.jsx)("textarea",{onChange:b,style:at,value:JSON.stringify({elements:t.map((function(e){return Object(p.a)(Object(p.a)({},e),{},{__rf:void 0})})),id:n,transform:s},null,2)}),Object(c.jsxs)("div",{style:rt,children:[Object(c.jsx)("button",{onClick:h,style:{marginRight:10},children:"clear"}),Object(c.jsx)("button",{onClick:v,children:f?"hide":"show"})]})]})};var ut=function(){var e=Object(a.useMemo)(it,[]),t=Object(a.useState)(e.id),n=Object(u.a)(t,2),r=n[0],i=n[1],o=Object(a.useState)(e.elements),d=Object(u.a)(o,2),f=d[0],j=d[1],m=Object(a.useState)(e.transform),b=Object(u.a)(m,2),h=b[0],p=b[1],O={elements:f,id:r,onChangeElementFactory:Object(a.useCallback)((function(e){return function(t){j(Object(l.a)((function(n){var c=n.filter(s.i).find((function(t){return t.id===e}));c&&Object.keys(t).forEach((function(e){return c.data[e]=t[e]}))})))}}),[j]),setElements:j,setId:i,setTransform:p,transform:h};return Object(c.jsx)(G.Provider,{value:O,children:Object(c.jsx)(v,{children:Object(c.jsx)(s.e,{children:Object(c.jsx)(w,{children:Object(c.jsx)(y,{children:Object(c.jsxs)("div",{style:{alignItems:"stretch",display:"flex",height:"100vh"},children:[Object(c.jsx)(ct,{},O.id),Object(c.jsx)(ot,{})]})})})})})})},st=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,39)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),r(e),i(e)}))};o.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(ut,{})}),document.getElementById("root")),st()}},[[32,1,2]]]);
//# sourceMappingURL=main.f80a5eb4.chunk.js.map