{"version":3,"sources":["context/AudioContext.tsx","components/Audio.tsx","components/Nodes.tsx","utils/handles.ts","context/NodeContext.tsx","components/nodes/Analyser/Visualiser.tsx","hooks/useAnimationFrame.ts","components/Node.tsx","components/nodes/Analyser/index.tsx","components/nodes/BiquadFilter.tsx","utils/channels.ts","components/nodes/ChannelMerger.tsx","components/nodes/ChannelSplitter.tsx","components/nodes/ConstantSource.tsx","components/nodes/Delay.tsx","components/nodes/Destination.tsx","components/nodes/DynamicsCompressor.tsx","components/nodes/Gain.tsx","components/nodes/Noise.tsx","components/nodes/Oscillator.tsx","utils/notes.ts","components/Note.tsx","components/nodes/OscillatorNote.tsx","components/nodes/StereoPanner.tsx","components/nodes/WaveShaper.tsx","components/Flow.tsx","components/Project.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["AudioContext","createContext","Audio","children","context","useMemo","window","webkitAudioContext","resume","useCallback","state","onClick","Provider","value","nodeCleanup","node","stop","disconnect","Nodes","nodes","useRef","addNode","id","current","getNode","removeNode","NodeContext","getChannelIndex","handle","match","resolveConnection","connection","source","target","sourceHandle","targetHandle","Error","connectToNode","startsWith","inputIndex","undefined","outputIndex","connectNodes","connect","e","console","error","useOnEdgeRemove","useNodeContext","edge","disconnectNodes","useContext","useNode","edges","useStoreState","store","useEffect","filter","forEach","Visualiser","paused","type","canvasProps","audioData","Uint8Array","frequencyBinCount","canvasRef","draw","canvas","getContext","DataType","TimeDomain","data","x","height","width","bufferLength","length","sliceWidth","fillStyle","fillRect","lineWidth","strokeStyle","beginPath","moveTo","i","y","lineTo","stroke","drawTimeDomainData","Frequency","barWidth","barHeight","drawFrequencyData","getData","dataArray","getByteTimeDomainData","getByteFrequencyData","callback","options","previousTimeRef","requestRef","maxFPS","animate","time","deltaTime","requestAnimationFrame","cancelAnimationFrame","useAnimationFrame","ref","style","display","React","memo","Node","inputs","outputs","title","handleStyle","background","substr","className","map","input","position","Position","Left","output","Right","Analyser","selected","nodeType","fftSizeExp","onChange","createAnalyser","fftSize","Math","pow","max","min","step","justifyContent","alignItems","checked","BiquadFilter","detune","gain","frequency","Q","createBiquadFilter","channelCounts","2","4","6","ChannelMerger","createChannelMerger","Array","numberOfInputs","fill","_","channel","flexDirection","Object","keys","channelCount","ChannelSplitter","createChannelSplitter","numberOfOutputs","ConstantSource","offset","createConstantSource","start","clampDelayTime","delayTime","Delay","maxDelayTime","createDelay","maxValue","minValue","Destination","destination","DynamicsCompressor","attack","knee","ratio","release","threshold","createDynamicsCompressor","Gain","createGain","setValueAtTime","currentTime","linearRampToValueAtTime","generateWhiteNoise","buffer","bufferSize","getChannelData","random","generatePinkNoise","b0","b1","b2","b3","b4","b5","b6","white","generateBrownNoise","lastOut","Noise","sampleRate","generator","brown","pink","createBuffer","log","createBufferSource","loop","Oscillator","createOscillator","NOTES","assertTwelfthValid","twelfth","RangeError","getNoteFrequency","octave","assertOctaveValid","getNoteName","modifierStyles","textAlign","octaveStyles","verticalAlign","accidentalStyles","transform","Note","split","name","accidental","toFixed","OscillatorNote","StereoPanner","pan","createStereoPanner","abs","WaveShaper","oversample","useState","curveFn","setCurveFn","lastValidCurveFn","setLastValidCurveFn","createWaveShaper","curve","Float32Array","Function","updateCurve","flexWrap","rows","nodeTypes","waitForInitialNodes","initialElements","audioNodes","a","nodesWithConnections","isEdge","reduce","nodeIds","nodeId","Promise","resolve","setTimeout","snapToGrid","floor","Flow","elements","initialTransform","showPopper","setShowPopper","popperElement","setPopperElement","virtualReference","setVirtualReference","usePopper","placement","styles","attributes","setElements","onElementsConnect","useOnConnect","onEdgeRemove","onNodeRemove","useOnNodeRemove","createOnChange","produce","draft","isNode","find","element","property","onLoad","reactFlowInstance","setTransform","onElementsRemove","elementsToRemove","removeElements","uuidv4","getBoundingClientRect","left","top","defaultPosition","defaultZoom","zoom","onConnect","params","assign","addEdge","onEdgeUpdate","oldEdge","newConnection","onNodeDragStop","event","draggedNode","onPaneClick","contains","onPaneContextMenu","preventDefault","clientY","clientX","onlyRenderVisibleElements","snapGrid","zIndex","gap","popper","textareaStyles","fontSize","resize","controlsStyles","right","transformOrigin","getDefaultProject","Project","setProject","visible","setVisible","mappedElements","__rf","mappedTransform","project","JSON","stringify","drawerStyles","padding","transition","getDrawerStyles","atob","location","hash","parse","btoa","clearProject","toggleProjectDrawer","marginRight","App","reportWebVitals","onPerfEntry","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.2923429d.chunk.js","sourcesContent":["import { createContext, useContext } from \"react\";\n\nexport const AudioContext = createContext<AudioContext>(null!);\n\nexport function useAudioContext() {\n  return useContext(AudioContext);\n}\n","import React, { useCallback, useMemo } from \"react\";\nimport { AudioContext } from \"context/AudioContext\";\n\ninterface Props {\n  children: React.ReactNode;\n}\n\nfunction Audio({ children }: Props) {\n  const context = useMemo(() => {\n    try {\n      if (!window.AudioContext) {\n        // @ts-ignore\n        window.AudioContext = window.webkitAudioContext;\n      }\n\n      return new window.AudioContext();\n    } catch {}\n  }, []);\n\n  const resume = useCallback(() => {\n    if (context?.state === \"suspended\") {\n      context.resume();\n    }\n  }, [context]);\n\n  if (!context) {\n    return <div>Sorry, but the Web Audio API is not supported by your browser.</div>;\n  }\n\n  return (\n    <div onClick={resume}>\n      <AudioContext.Provider value={context}>{children}</AudioContext.Provider>\n    </div>\n  );\n}\n\nexport default Audio;\n","import React, { useMemo, useRef } from \"react\";\nimport { NodeContext, NodeContextType } from \"context/NodeContext\";\n\ninterface Props {\n  children: React.ReactNode;\n}\n\nexport function nodeCleanup(node: AudioNode) {\n  (node as any).stop?.();\n  node.disconnect();\n}\n\nfunction Nodes({ children }: Props) {\n  const nodes = useRef<NodeContextType[\"nodes\"]>({});\n  const context: NodeContextType = useMemo(\n    () => ({\n      addNode: (id, node) => {\n        nodes.current[id] = node;\n      },\n      getNode: id => nodes.current[id],\n      nodes: nodes.current,\n      removeNode: id => {\n        nodeCleanup(nodes.current[id]);\n        delete nodes.current[id];\n      },\n    }),\n    []\n  );\n\n  return (\n    <div>\n      <NodeContext.Provider value={context}>{children}</NodeContext.Provider>\n    </div>\n  );\n}\n\nexport default Nodes;\n","import { useCallback } from \"react\";\nimport { Connection, Edge } from \"react-flow-renderer\";\nimport { useNodeContext } from \"context/NodeContext\";\nimport { nodeCleanup } from \"components/Nodes\";\n\nfunction getChannelIndex(handle: string): number {\n  return +(handle.match(/-(\\d+)$/)?.[1] ?? 0);\n}\n\ninterface ResolvedConnection {\n  inputIndex?: number;\n  outputIndex?: number;\n  source: AudioNode;\n  target: AudioNode | AudioParam;\n}\n\nfunction resolveConnection(\n  connection: Edge | Connection,\n  getNode: (id: string) => AudioNode\n): ResolvedConnection | never {\n  if (!connection.source || !connection.target || !connection.sourceHandle || !connection.targetHandle) {\n    throw new Error(\"Invalid connection\");\n  }\n\n  const connectToNode = connection.targetHandle.startsWith(\"input\");\n  const source = getNode(connection.source);\n  const target = getNode(connection.target);\n\n  return {\n    inputIndex: connectToNode ? getChannelIndex(connection.targetHandle) : undefined,\n    outputIndex: getChannelIndex(connection.sourceHandle),\n    source: source,\n    target: connectToNode\n      ? target\n      : // @ts-ignore\n        target[connection.targetHandle],\n  };\n}\n\nexport function connectNodes(connection: Edge | Connection, getNode: (id: string) => AudioNode) {\n  try {\n    const { inputIndex, outputIndex, source, target } = resolveConnection(connection, getNode);\n    if (inputIndex != null) {\n      // @ts-ignore\n      source.connect(target, outputIndex, inputIndex);\n    } else {\n      // @ts-ignore\n      source.connect(target, outputIndex);\n    }\n  } catch (e) {\n    console.error(e);\n  }\n}\n\nexport function disconnectNodes(connection: Edge | Connection, getNode: (id: string) => AudioNode) {\n  try {\n    const { inputIndex, outputIndex, source, target } = resolveConnection(connection, getNode);\n    if (inputIndex != null) {\n      // @ts-ignore\n      source.disconnect(target, outputIndex, inputIndex);\n    } else {\n      // @ts-ignore\n      source.disconnect(target, outputIndex);\n    }\n  } catch (e) {\n    console.error(e);\n  }\n}\n\n// FIXME This should be handled on changes to ReactFlowRenderer state instead.\nexport function useOnConnect() {\n  const { getNode } = useNodeContext();\n\n  return useCallback((connection: Edge | Connection) => connectNodes(connection, getNode), [getNode]);\n}\n\n// FIXME This should be handled on changes to ReactFlowRenderer state instead.\nexport function useOnEdgeRemove() {\n  const { getNode } = useNodeContext();\n\n  return useCallback((edge: Edge) => disconnectNodes(edge, getNode), [getNode]);\n}\n\n// FIXME This should be handled on changes to ReactFlowRenderer state instead.\nexport function useOnNodeRemove() {\n  const { getNode } = useNodeContext();\n\n  return useCallback((nodeId: string) => nodeCleanup(getNode(nodeId)), [getNode]);\n}\n","import { createContext, useContext, useEffect } from \"react\";\nimport { useStoreState } from \"react-flow-renderer\";\nimport { connectNodes } from \"utils/handles\";\n\nexport type NodeContextType = {\n  addNode: (id: string, node: AudioNode) => void;\n  getNode: (id: string) => AudioNode;\n  nodes: Record<string, AudioNode>;\n  removeNode: (id: string) => void;\n};\n\nexport const NodeContext = createContext<NodeContextType>(null!);\n\nexport function useNodeContext() {\n  return useContext(NodeContext);\n}\n\nexport function useNode(id: string, node: AudioNode) {\n  const { addNode, getNode, removeNode } = useNodeContext();\n  const edges = useStoreState(store => store.edges);\n\n  useEffect(() => {\n    addNode(id, node);\n\n    // try reconnecting\n    edges.filter(edge => edge.source === id || edge.target === id).forEach(edge => connectNodes(edge, getNode));\n\n    return () => {\n      removeNode(id);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [addNode, getNode, node, id, removeNode]);\n}\n","import React, { useCallback, useRef } from \"react\";\nimport { DataType } from \"components/nodes/Analyser/index\";\nimport useAnimationFrame from \"hooks/useAnimationFrame\";\n\ninterface OwnProps {\n  node: AnalyserNode;\n  paused: boolean;\n  type: DataType;\n}\n\ntype Props = OwnProps & React.ComponentProps<\"canvas\">;\n\nfunction drawTimeDomainData(context: CanvasRenderingContext2D, data: Uint8Array) {\n  let x = 0;\n  const height = context.canvas.height;\n  const width = context.canvas.width;\n  const bufferLength = data.length;\n  const sliceWidth = width / bufferLength;\n\n  context.fillStyle = \"#001400\";\n  context.fillRect(0, 0, width, 256);\n\n  context.lineWidth = 2;\n  context.strokeStyle = \"#00c800\";\n  context.beginPath();\n  context.moveTo(x, height - ((data[0] / 128.0) * height) / 2);\n  for (let i = 1; i < bufferLength; i++) {\n    const y = ((data[i] / 128.0) * height) / 2;\n    context.lineTo(x, height - y);\n    x += sliceWidth;\n  }\n  context.stroke();\n}\n\nfunction drawFrequencyData(context: CanvasRenderingContext2D, data: Uint8Array) {\n  let x = 0;\n  const height = context.canvas.height;\n  const width = context.canvas.width;\n  const bufferLength = data.length;\n  const barWidth = width / bufferLength;\n\n  context.fillStyle = \"#001400\";\n  context.fillRect(0, 0, width, 256);\n\n  context.fillStyle = \"#00c800\";\n  for (let i = 0; i < bufferLength; i++) {\n    const barHeight = height * (data[i] / 255.0);\n    const y = height - barHeight;\n    context.fillRect(x, y, barWidth, barHeight);\n    x += barWidth;\n  }\n}\n\nfunction Visualiser({ node, paused, type, ...canvasProps }: Props) {\n  const audioData = useRef(new Uint8Array(node.frequencyBinCount));\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  const draw = useCallback(() => {\n    const canvas = canvasRef.current;\n    const context = canvas?.getContext(\"2d\");\n    if (!canvas || !context) {\n      return;\n    }\n\n    if (type === DataType.TimeDomain) {\n      drawTimeDomainData(context, audioData.current);\n    } else if (type === DataType.Frequency) {\n      drawFrequencyData(context, audioData.current);\n    }\n  }, [type]);\n\n  const getData = useCallback(() => {\n    const bufferLength = node.frequencyBinCount;\n    const dataArray = new Uint8Array(bufferLength);\n    if (type === DataType.TimeDomain) {\n      node.getByteTimeDomainData(dataArray);\n    } else if (type === DataType.Frequency) {\n      node.getByteFrequencyData(dataArray);\n    }\n    audioData.current = dataArray;\n  }, [node, type]);\n\n  const tick = useCallback(() => {\n    if (!paused) {\n      getData();\n      draw();\n    }\n  }, [draw, getData, paused]);\n\n  useAnimationFrame(tick);\n\n  return <canvas ref={canvasRef} style={{ display: \"block\" }} {...canvasProps} />;\n}\n\nexport default React.memo(Visualiser);\n","import { useCallback, useEffect, useRef } from \"react\";\n\ninterface Options {\n  maxFPS?: number;\n}\n\nexport default function useAnimationFrame(callback: FrameRequestCallback, options?: Options): void {\n  const previousTimeRef = useRef<DOMHighResTimeStamp>();\n  const requestRef = useRef<number>();\n  const maxFPS = options?.maxFPS;\n\n  const animate = useCallback(\n    (time: DOMHighResTimeStamp): void => {\n      if (previousTimeRef.current != null) {\n        const deltaTime = time - previousTimeRef.current;\n        if (!maxFPS || deltaTime > 1000 / maxFPS) {\n          callback(deltaTime);\n          previousTimeRef.current = time;\n        }\n      } else {\n        callback(0);\n        previousTimeRef.current = time;\n      }\n\n      requestRef.current = requestAnimationFrame(animate);\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [callback]\n  );\n\n  useEffect(() => {\n    requestRef.current = requestAnimationFrame(animate);\n\n    return (): void => {\n      if (requestRef.current != null) {\n        cancelAnimationFrame(requestRef.current);\n      }\n    };\n  }, [animate]);\n}\n","import React, { useMemo } from \"react\";\nimport { Handle, NodeProps, Position } from \"react-flow-renderer\";\n\ninterface Props {\n  children?: React.ReactNode;\n  id: NodeProps[\"id\"];\n  inputs?: string[];\n  outputs?: string[];\n  title?: React.ReactNode;\n  type: NodeProps[\"type\"];\n}\n\nfunction Node({ children, id, inputs, outputs, title, type }: Props) {\n  const handleStyle = useMemo(\n    () => ({\n      background: `#${id.substr(-6)}`,\n    }),\n    [id]\n  );\n\n  return (\n    <div className=\"customNode\" title={id}>\n      <div className=\"customNode_header\">{title ?? type}</div>\n      <div className=\"customNode_body\">\n        {inputs && (\n          <div className=\"customNode_inputs\">\n            {inputs.map(input => (\n              <div key={input} className=\"customNode_item\">\n                <Handle id={input} position={Position.Left} style={handleStyle} type=\"target\" />\n                {input}\n              </div>\n            ))}\n          </div>\n        )}\n        {outputs && (\n          <div className=\"customNode_outputs\">\n            {outputs.map(output => (\n              <div key={output} className=\"customNode_item\">\n                <Handle id={output} position={Position.Right} style={handleStyle} type=\"source\" />\n                {output}\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n      {children}\n    </div>\n  );\n}\n\nexport default React.memo(Node);\n","import React, { useContext, useEffect, useMemo } from \"react\";\nimport { NodeProps } from \"react-flow-renderer\";\nimport { AudioContext } from \"context/AudioContext\";\nimport { useNode } from \"context/NodeContext\";\nimport Visualiser from \"./Visualiser\";\nimport Node from \"components/Node\";\n\nexport enum DataType {\n  Frequency = \"Frequency\",\n  TimeDomain = \"Time Domain\",\n}\n\nfunction Analyser({ data, id, selected, type: nodeType }: NodeProps) {\n  const { fftSizeExp = 11, onChange, paused = false, type = DataType.TimeDomain } = data;\n\n  // AudioNode\n  const context = useContext(AudioContext);\n  const node = useMemo<AnalyserNode>(() => context.createAnalyser(), [context]);\n  useNode(id, node);\n\n  // AudioParam\n  useEffect(() => void (node.fftSize = Math.pow(2, fftSizeExp)), [node, fftSizeExp]);\n\n  return (\n    <Node id={id} inputs={[\"input\", \"fftSize\"]} outputs={[\"output\"]} title={`Analyser: ${type}`} type={nodeType}>\n      <div className=\"customNode_item\">\n        <Visualiser type={type} node={node} paused={paused} height={64} width={256} />\n      </div>\n      {selected && (\n        <div className=\"customNode_editor\">\n          <div className=\"customNode_item\">\n            <input\n              className=\"nodrag\"\n              type=\"range\"\n              max=\"15\"\n              min=\"5\"\n              onChange={e => onChange({ fftSizeExp: +e.target.value })}\n              step={1}\n              value={fftSizeExp}\n            />\n            {Math.pow(2, fftSizeExp)}\n          </div>\n          <div className=\"customNode_item\" style={{ justifyContent: \"space-between\" }}>\n            <select onChange={e => onChange({ type: e.target.value })} value={type}>\n              <option value={DataType.Frequency}>{DataType.Frequency}</option>\n              <option value={DataType.TimeDomain}>{DataType.TimeDomain}</option>\n            </select>\n            <label\n              style={{\n                alignItems: \"center\",\n                display: \"flex\",\n              }}\n            >\n              <input\n                className=\"nodrag\"\n                type=\"checkbox\"\n                checked={paused}\n                onChange={e => onChange({ paused: !paused })}\n              />\n              Paused\n            </label>\n          </div>\n        </div>\n      )}\n    </Node>\n  );\n}\n\nexport default React.memo(Analyser);\n","import React, { useContext, useEffect, useMemo } from \"react\";\nimport { NodeProps } from \"react-flow-renderer\";\nimport { AudioContext } from \"context/AudioContext\";\nimport { useNode } from \"context/NodeContext\";\nimport Node from \"components/Node\";\n\nfunction BiquadFilter({ data, id, selected, type: nodeType }: NodeProps) {\n  const { detune = 0, gain = 0, frequency = 350, Q = 1, onChange, type = \"lowpass\" } = data;\n\n  // AudioNode\n  const context = useContext(AudioContext);\n  const node = useMemo<BiquadFilterNode>(() => context.createBiquadFilter(), [context]);\n  useNode(id, node);\n\n  // AudioParam\n  useEffect(() => void (node.detune.value = detune), [node, detune]);\n  useEffect(() => void (node.frequency.value = frequency), [node, frequency]);\n  useEffect(() => void (node.gain.value = gain), [node, gain]);\n  useEffect(() => void (node.Q.value = Q), [node, Q]);\n  useEffect(() => void (node.type = type), [node, type]);\n\n  return (\n    <Node\n      id={id}\n      inputs={[\"input\", \"detune\", \"frequency\", \"gain\", \"Q\"]}\n      outputs={[\"output\"]}\n      title={`Filter: ${type}`}\n      type={nodeType}\n    >\n      {selected && (\n        <div className=\"customNode_editor\">\n          <div className=\"customNode_item\">\n            <input\n              className=\"nodrag\"\n              min={-100}\n              max={100}\n              onChange={e => onChange({ detune: +e.target.value })}\n              step={1}\n              type=\"range\"\n              value={detune}\n            />\n          </div>\n          <div className=\"customNode_item\">\n            <input\n              className=\"nodrag\"\n              min={0}\n              max={22050}\n              onChange={e => onChange({ frequency: +e.target.value })}\n              type=\"number\"\n              value={frequency}\n            />\n          </div>\n          <div className=\"customNode_item\">\n            <input\n              className=\"nodrag\"\n              min={-40}\n              max={40}\n              onChange={e => onChange({ gain: +e.target.value })}\n              step={0.1}\n              type=\"range\"\n              value={gain}\n            />\n          </div>\n          <div className=\"customNode_item\">\n            <input\n              className=\"nodrag\"\n              min={0.0001}\n              max={1000}\n              onChange={e => onChange({ Q: +e.target.value })}\n              type=\"number\"\n              value={Q}\n            />\n          </div>\n          <div className=\"customNode_item\">\n            <select onChange={e => onChange({ type: e.target.value })} value={type}>\n              <option value=\"lowpass\">lowpass</option>\n              <option value=\"highpass\">highpass</option>\n              <option value=\"bandpass\">bandpass</option>\n              <option value=\"lowshelf\">lowshelf</option>\n              <option value=\"highshelf\">highshelf</option>\n              <option value=\"peaking\">peaking</option>\n              <option value=\"notch\">notch</option>\n              <option value=\"allpass\">allpass</option>\n            </select>\n          </div>\n        </div>\n      )}\n    </Node>\n  );\n}\n\nexport default React.memo(BiquadFilter);\n","export const channelCounts = {\n  2: \"Stereo\",\n  4: \"Quad\",\n  6: \"5.1\",\n};\n","import React, { useContext, useMemo } from \"react\";\nimport { NodeProps } from \"react-flow-renderer\";\nimport { AudioContext } from \"context/AudioContext\";\nimport { useNode } from \"context/NodeContext\";\nimport Node from \"components/Node\";\nimport { channelCounts } from \"utils/channels\";\n\nfunction ChannelMerger({ data, id, selected, type }: NodeProps) {\n  const { inputs = 2, onChange } = data;\n\n  // AudioNode\n  const context = useContext(AudioContext);\n  const node = useMemo<ChannelMergerNode>(() => context.createChannelMerger(inputs), [context, inputs]);\n  useNode(id, node);\n\n  return (\n    <Node\n      id={id}\n      inputs={Array(node.numberOfInputs)\n        .fill(0)\n        .map((_, channel) => `input-${channel}`)}\n      outputs={[\"output\"]}\n      type={type}\n    >\n      {selected && (\n        <div className=\"customNode_editor\">\n          <div\n            className=\"customNode_item\"\n            style={{\n              alignItems: \"flex-start\",\n              flexDirection: \"column\",\n            }}\n          >\n            {Object.keys(channelCounts).map(channelCount => (\n              <label key={channelCount}>\n                <input\n                  checked={inputs === +channelCount}\n                  className=\"nodrag\"\n                  onChange={e => onChange({ inputs: +e.target.value })}\n                  type=\"radio\"\n                  value={+channelCount}\n                />{\" \"}\n                {/* @ts-ignore */}\n                {channelCounts[channelCount]}\n              </label>\n            ))}\n          </div>\n        </div>\n      )}\n    </Node>\n  );\n}\n\nexport default React.memo(ChannelMerger);\n","import React, { useContext, useMemo } from \"react\";\nimport { NodeProps } from \"react-flow-renderer\";\nimport { AudioContext } from \"context/AudioContext\";\nimport { useNode } from \"context/NodeContext\";\nimport Node from \"components/Node\";\nimport { channelCounts } from \"utils/channels\";\n\nfunction ChannelSplitter({ data, id, selected, type }: NodeProps) {\n  const { onChange, outputs = 2 } = data;\n\n  // AudioNode\n  const context = useContext(AudioContext);\n  const node = useMemo<ChannelSplitterNode>(() => context.createChannelSplitter(outputs), [context, outputs]);\n  useNode(id, node);\n\n  return (\n    <Node\n      id={id}\n      inputs={[\"input\"]}\n      outputs={Array(node.numberOfOutputs)\n        .fill(0)\n        .map((_, channel) => `output-${channel}`)}\n      type={type}\n    >\n      {selected && (\n        <div className=\"customNode_editor\">\n          <div\n            className=\"customNode_item\"\n            style={{\n              alignItems: \"flex-start\",\n              flexDirection: \"column\",\n            }}\n          >\n            {Object.keys(channelCounts).map(channelCount => (\n              <label key={channelCount}>\n                <input\n                  checked={outputs === +channelCount}\n                  className=\"nodrag\"\n                  onChange={e => onChange({ outputs: +e.target.value })}\n                  type=\"radio\"\n                  value={+channelCount}\n                />{\" \"}\n                {/* @ts-ignore */}\n                {channelCounts[channelCount]}\n              </label>\n            ))}\n          </div>\n        </div>\n      )}\n    </Node>\n  );\n}\n\nexport default React.memo(ChannelSplitter);\n","import React, { useContext, useEffect, useMemo } from \"react\";\nimport { NodeProps } from \"react-flow-renderer\";\nimport { AudioContext } from \"context/AudioContext\";\nimport { useNode } from \"context/NodeContext\";\nimport Node from \"components/Node\";\n\nfunction ConstantSource({ data, id, selected, type }: NodeProps) {\n  const { offset = 1, onChange } = data;\n\n  // AudioNode\n  const context = useContext(AudioContext);\n  const node = useMemo<ConstantSourceNode>(() => context.createConstantSource(), [context]);\n  useEffect(() => {\n    node.start();\n    return () => node.stop();\n  }, [node]);\n  useNode(id, node);\n\n  // AudioParam\n  useEffect(() => (node.offset.value = offset), [node, offset]);\n\n  return (\n    <Node id={id} outputs={[\"output\"]} title={`Constant: ${offset}`} type={type}>\n      {selected && (\n        <div className=\"customNode_editor\">\n          <div className=\"customNode_item\">\n            <input\n              className=\"nodrag\"\n              type=\"number\"\n              onChange={e => onChange({ offset: +e.target.value })}\n              style={{ width: \"100%\" }}\n              value={offset}\n            />\n          </div>\n        </div>\n      )}\n    </Node>\n  );\n}\n\nexport default React.memo(ConstantSource);\n","import React, { useContext, useEffect, useMemo } from \"react\";\nimport { NodeProps } from \"react-flow-renderer\";\nimport { AudioContext } from \"context/AudioContext\";\nimport { useNode } from \"context/NodeContext\";\nimport Node from \"components/Node\";\n\nfunction clampDelayTime(delayTime: number) {\n  return Math.max(0.001, Math.min(179.999, delayTime));\n}\n\nfunction Delay({ data, id, selected, type }: NodeProps) {\n  const { delayTime = 1, maxDelayTime = 1, onChange } = data;\n\n  // AudioNode\n  const context = useContext(AudioContext);\n  const node = useMemo<DelayNode>(() => context.createDelay(clampDelayTime(maxDelayTime)), [context, maxDelayTime]);\n  useNode(id, node);\n\n  // AudioParam\n  useEffect(() => void (node.delayTime.value = delayTime), [node, delayTime]);\n\n  return (\n    <Node id={id} inputs={[\"input\", \"delayTime\"]} outputs={[\"output\"]} title={`Delay: ${delayTime} s`} type={type}>\n      {selected && (\n        <div className=\"customNode_editor\">\n          <div className=\"customNode_item\">\n            <input\n              className=\"nodrag\"\n              max={node.delayTime.maxValue}\n              min={node.delayTime.minValue}\n              step={0.1}\n              onChange={e => onChange({ delayTime: +e.target.value })}\n              type=\"range\"\n              value={delayTime}\n            />\n          </div>\n          <div className=\"customNode_item\">\n            <input\n              className=\"nodrag\"\n              onChange={e => onChange({ maxDelayTime: +e.target.value })}\n              max={0}\n              min={180}\n              type=\"number\"\n              value={clampDelayTime(maxDelayTime)}\n            />\n          </div>\n        </div>\n      )}\n    </Node>\n  );\n}\n\nexport default React.memo(Delay);\n","import React, { useContext } from \"react\";\nimport { NodeProps } from \"react-flow-renderer\";\nimport { AudioContext } from \"context/AudioContext\";\nimport { useNode } from \"context/NodeContext\";\nimport Node from \"components/Node\";\n\nfunction Destination({ id, type }: NodeProps) {\n  // AudioNode\n  const context = useContext(AudioContext);\n  const node = context.destination;\n  useNode(id, node);\n\n  return <Node id={id} inputs={[\"input\"]} type={type} />;\n}\n\nexport default React.memo(Destination);\n","import React, { useContext, useEffect, useMemo } from \"react\";\nimport { NodeProps } from \"react-flow-renderer\";\nimport { AudioContext } from \"context/AudioContext\";\nimport { useNode } from \"context/NodeContext\";\nimport Node from \"components/Node\";\n\nfunction DynamicsCompressor({ data, id, selected, type }: NodeProps) {\n  const { attack = 0.003, knee = 30, onChange, ratio = 12, release = 0.25, threshold = -24 } = data;\n\n  // AudioNode\n  const context = useContext(AudioContext);\n  const node = useMemo<DynamicsCompressorNode>(() => context.createDynamicsCompressor(), [context]);\n  useNode(id, node);\n\n  // AudioParam\n  useEffect(() => void (node.threshold.value = threshold), [node, threshold]);\n  useEffect(() => void (node.knee.value = knee), [node, knee]);\n  useEffect(() => void (node.ratio.value = ratio), [node, ratio]);\n  useEffect(() => void (node.attack.value = attack), [node, attack]);\n  useEffect(() => void (node.release.value = release), [node, release]);\n\n  return (\n    <Node\n      id={id}\n      inputs={[\"input\", \"threshold\", \"knee\", \"ratio\", \"attack\", \"release\"]}\n      outputs={[\"output\"]}\n      type={type}\n    >\n      {selected && (\n        <div className=\"customNode_editor\">\n          <div className=\"customNode_item\">\n            <input\n              className=\"nodrag\"\n              type=\"range\"\n              max=\"0\"\n              min=\"-100\"\n              step=\"1\"\n              onChange={e => onChange({ threshold: +e.target.value })}\n              value={threshold}\n            />\n          </div>\n          <div className=\"customNode_item\">\n            <input\n              className=\"nodrag\"\n              type=\"range\"\n              max=\"40\"\n              min=\"0\"\n              step=\"1\"\n              onChange={e => onChange({ knee: +e.target.value })}\n              value={knee}\n            />\n          </div>\n          <div className=\"customNode_item\">\n            <input\n              className=\"nodrag\"\n              type=\"range\"\n              max=\"20\"\n              min=\"1\"\n              step=\"1\"\n              onChange={e => onChange({ ratio: +e.target.value })}\n              value={ratio}\n            />\n          </div>\n          <div className=\"customNode_item\">\n            <input\n              className=\"nodrag\"\n              type=\"range\"\n              max=\"1\"\n              min=\"0\"\n              step=\"0.001\"\n              onChange={e => onChange({ attack: +e.target.value })}\n              value={attack}\n            />\n          </div>\n          <div className=\"customNode_item\">\n            <input\n              className=\"nodrag\"\n              type=\"range\"\n              max=\"1\"\n              min=\"0\"\n              step=\"0.001\"\n              onChange={e => onChange({ release: +e.target.value })}\n              value={release}\n            />\n          </div>\n        </div>\n      )}\n    </Node>\n  );\n}\n\nexport default React.memo(DynamicsCompressor);\n","import React, { useContext, useEffect, useMemo } from \"react\";\nimport { NodeProps } from \"react-flow-renderer\";\nimport { AudioContext } from \"context/AudioContext\";\nimport { useNode } from \"context/NodeContext\";\nimport Node from \"components/Node\";\n\nfunction Gain({ data, id, selected, type }: NodeProps) {\n  const { gain = 1, onChange } = data;\n\n  // AudioNode\n  const context = useContext(AudioContext);\n  const node = useMemo<GainNode>(() => context.createGain(), [context]);\n  useNode(id, node);\n\n  // AudioParam\n  useEffect(() => {\n    node.gain.setValueAtTime(node.gain.value, context.currentTime);\n    node.gain.linearRampToValueAtTime(gain, context.currentTime + 0.01);\n  }, [context, node, gain]);\n\n  return (\n    <Node id={id} inputs={[\"input\", \"gain\"]} outputs={[\"output\"]} title={`Gain: ${gain}`} type={type}>\n      {selected && (\n        <div className=\"customNode_editor\">\n          <div className=\"customNode_item\">\n            <input\n              className=\"nodrag\"\n              type=\"range\"\n              max=\"1\"\n              min=\"-1\"\n              step=\"0.01\"\n              onChange={e => onChange({ gain: +e.target.value })}\n              value={gain}\n            />\n          </div>\n        </div>\n      )}\n    </Node>\n  );\n}\n\nexport default React.memo(Gain);\n","import React, { useContext, useEffect, useMemo } from \"react\";\nimport { NodeProps } from \"react-flow-renderer\";\nimport { AudioContext } from \"context/AudioContext\";\nimport { useNode } from \"context/NodeContext\";\nimport Node from \"components/Node\";\n\n// See: https://noisehack.com/generate-noise-web-audio-api/\nfunction generateWhiteNoise(buffer: AudioBuffer) {\n  const bufferSize = buffer.length;\n  const output = buffer.getChannelData(0);\n  for (let i = 0; i < bufferSize; i++) {\n    output[i] = Math.random() * 2 - 1;\n  }\n\n  return buffer;\n}\n\n// See: https://noisehack.com/generate-noise-web-audio-api/\nfunction generatePinkNoise(buffer: AudioBuffer) {\n  const bufferSize = buffer.length;\n  const output = buffer.getChannelData(0);\n  let b0 = 0;\n  let b1 = 0;\n  let b2 = 0;\n  let b3 = 0;\n  let b4 = 0;\n  let b5 = 0;\n  let b6 = 0;\n  for (let i = 0; i < bufferSize; i++) {\n    const white = Math.random() * 2 - 1;\n    b0 = 0.99886 * b0 + white * 0.0555179;\n    b1 = 0.99332 * b1 + white * 0.0750759;\n    b2 = 0.969 * b2 + white * 0.153852;\n    b3 = 0.8665 * b3 + white * 0.3104856;\n    b4 = 0.55 * b4 + white * 0.5329522;\n    b5 = -0.7616 * b5 - white * 0.016898;\n    output[i] = b0 + b1 + b2 + b3 + b4 + b5 + b6 + white * 0.5362;\n    output[i] *= 0.11; // (roughly) compensate for gain\n    b6 = white * 0.115926;\n  }\n\n  return buffer;\n}\n\n// See: https://noisehack.com/generate-noise-web-audio-api/\nfunction generateBrownNoise(buffer: AudioBuffer) {\n  const bufferSize = buffer.length;\n  const output = buffer.getChannelData(0);\n  let lastOut = 0.0;\n  for (let i = 0; i < bufferSize; i++) {\n    const white = Math.random() * 2 - 1;\n    output[i] = (lastOut + 0.02 * white) / 1.02;\n    lastOut = output[i];\n    output[i] *= 3.5; // (roughly) compensate for gain\n  }\n\n  return buffer;\n}\n\nfunction Noise({ data, id, selected, type: nodeType }: NodeProps) {\n  const { onChange, type = \"white\" } = data;\n\n  // AudioNode\n  const context = useContext(AudioContext);\n  const node = useMemo<AudioBufferSourceNode>(() => {\n    // Will create buffer with 5 seconds of noise\n    const bufferSize = 5 * context.sampleRate;\n    const generators = {\n      brown: generateBrownNoise,\n      pink: generatePinkNoise,\n      white: generateWhiteNoise,\n    };\n    const generator = generators[type as keyof typeof generators];\n    const buffer = generator(context.createBuffer(1, bufferSize, context.sampleRate));\n    console.log(buffer.getChannelData(0));\n    const node = context.createBufferSource();\n    node.buffer = buffer;\n    node.loop = true;\n\n    return node;\n  }, [context, type]);\n  useEffect(() => {\n    node.start();\n    return () => node.stop();\n  }, [node]);\n  useNode(id, node);\n\n  return (\n    <Node id={id} inputs={[\"input\"]} outputs={[\"output\"]} title={`Noise: ${type}`} type={nodeType}>\n      {selected && (\n        <div className=\"customNode_editor\">\n          <div className=\"customNode_item\">\n            <select onChange={e => onChange({ type: e.target.value })} value={type}>\n              <option value=\"white\">white</option>\n              <option value=\"pink\">pink</option>\n              <option value=\"brown\">brown</option>\n            </select>\n          </div>\n        </div>\n      )}\n    </Node>\n  );\n}\n\nexport default React.memo(Noise);\n","import React, { useContext, useEffect, useMemo } from \"react\";\nimport { NodeProps } from \"react-flow-renderer\";\nimport { AudioContext } from \"context/AudioContext\";\nimport { useNode } from \"context/NodeContext\";\nimport Node from \"components/Node\";\n\nfunction Oscillator({ data, id, selected, type: nodeType }: NodeProps) {\n  const { detune = 0, frequency = 440, onChange, type = \"sine\" } = data;\n\n  // AudioNode\n  const context = useContext(AudioContext);\n  const node = useMemo<OscillatorNode>(() => context.createOscillator(), [context]);\n  useEffect(() => {\n    node.start();\n    return () => node.stop();\n  }, [node]);\n  useNode(id, node);\n\n  // AudioParam\n  useEffect(() => void (node.detune.value = detune ?? 0), [node, detune]);\n  useEffect(() => void (node.frequency.value = frequency ?? 440), [node, frequency]);\n  useEffect(() => void (node.type = type ?? \"sine\"), [node, type]);\n\n  return (\n    <Node\n      id={id}\n      inputs={[\"detune\", \"frequency\"]}\n      outputs={[\"output\"]}\n      title={`${frequency} Hz ${type}`}\n      type={nodeType}\n    >\n      {selected && (\n        <div className=\"customNode_editor\">\n          <div className=\"customNode_item\">\n            <input\n              className=\"nodrag\"\n              min={-100}\n              max={100}\n              onChange={e => onChange({ detune: +e.target.value })}\n              step={1}\n              type=\"number\"\n              value={detune}\n            />\n          </div>\n          <div className=\"customNode_item\">\n            <input\n              className=\"nodrag\"\n              min={0}\n              max={20000}\n              onChange={e => onChange({ frequency: +e.target.value })}\n              type=\"number\"\n              value={frequency}\n            />\n          </div>\n          <div className=\"customNode_item\">\n            <select onChange={e => onChange({ type: e.target.value })} value={type}>\n              <option value=\"sawtooth\">sawtooth</option>\n              <option value=\"square\">square</option>\n              <option value=\"sine\">sine</option>\n              <option value=\"triangle\">triangle</option>\n            </select>\n          </div>\n        </div>\n      )}\n    </Node>\n  );\n}\n\nexport default React.memo(Oscillator);\n","const NOTES = [\"C\", \"C♯\", \"D\", \"D♯\", \"E\", \"F\", \"F♯\", \"G\", \"G♯\", \"A\", \"A♯\", \"B\"];\n\nexport function assertOctaveValid(octave: number) {\n  if (octave < 0 || octave > 10) {\n    throw new RangeError(`Octave must be between 0 and 10, is ${octave}`);\n  }\n}\n\nexport function assertTwelfthValid(twelfth: number) {\n  if (twelfth < 0 || twelfth > 11) {\n    throw new RangeError(`Octave must be between 0 and 11, is ${twelfth}`);\n  }\n}\n\nexport function getNoteFrequency(octave: number, twelfth: number) {\n  assertOctaveValid(octave);\n  assertTwelfthValid(twelfth);\n\n  const C0 = 16.3516;\n  return C0 * Math.pow(2, octave + twelfth / 12);\n}\n\nexport function getNoteName(twelfth: number) {\n  assertTwelfthValid(twelfth);\n\n  return NOTES[twelfth];\n}\n","import React from \"react\";\nimport { getNoteFrequency, getNoteName } from \"utils/notes\";\n\ninterface Props {\n  octave: number;\n  twelfth: number;\n}\n\nconst modifierStyles: React.CSSProperties = {\n  display: \"inline-block\",\n  textAlign: \"center\",\n  width: 7,\n};\nconst octaveStyles: React.CSSProperties = {\n  ...modifierStyles,\n  verticalAlign: \"sub\",\n};\nconst accidentalStyles: React.CSSProperties = {\n  ...modifierStyles,\n  transform: \"translateX(-100%)\",\n  verticalAlign: \"super\",\n};\n\nfunction Note({ octave, twelfth }: Props) {\n  const [name, accidental] = getNoteName(twelfth).split(\"\");\n  const frequency = getNoteFrequency(octave, twelfth);\n\n  return (\n    <span>\n      {name}\n      <small style={octaveStyles}>{octave}</small>\n      {accidental && <small style={accidentalStyles}>{accidental}</small>}\n      <small> ({frequency.toFixed(2)} Hz)</small>\n    </span>\n  );\n}\n\nexport default React.memo(Note);\n","import React, { useContext, useEffect, useMemo } from \"react\";\nimport { NodeProps } from \"react-flow-renderer\";\nimport Note from \"components/Note\";\nimport { AudioContext } from \"context/AudioContext\";\nimport { useNode } from \"context/NodeContext\";\nimport { getNoteFrequency, getNoteName } from \"utils/notes\";\nimport Node from \"components/Node\";\n\nfunction OscillatorNote({ data, id, selected, type: nodeType }: NodeProps) {\n  const { detune = 0, octave = 4, onChange, twelfth = 0, type = \"sine\" } = data;\n  const frequency = getNoteFrequency(octave, twelfth);\n\n  // AudioNode\n  const context = useContext(AudioContext);\n  const node = useMemo<OscillatorNode>(() => context.createOscillator(), [context]);\n  useEffect(() => {\n    node.start();\n    return () => node.stop();\n  }, [node]);\n  useNode(id, node);\n\n  // AudioParam\n  useEffect(() => void (node.detune.value = detune ?? 0), [node, detune]);\n  useEffect(() => void (node.frequency.value = frequency), [node, frequency]);\n  useEffect(() => void (node.type = type ?? \"sine\"), [node, type]);\n\n  return (\n    <Node\n      id={id}\n      inputs={[\"detune\"]}\n      outputs={[\"output\"]}\n      title={<Note octave={octave} twelfth={twelfth} />}\n      type={nodeType}\n    >\n      {selected && (\n        <div className=\"customNode_editor\">\n          <div className=\"customNode_item\">\n            <input\n              className=\"nodrag\"\n              min={-100}\n              max={100}\n              onChange={e => onChange({ detune: +e.target.value })}\n              step={1}\n              style={{ width: \"100%\" }}\n              type=\"range\"\n              value={detune}\n            />\n          </div>\n          <div className=\"customNode_item\">\n            <select onChange={e => onChange({ twelfth: +e.target.value })} style={{ width: \"50%\" }} value={twelfth}>\n              {Array(12)\n                .fill(0)\n                .map((_, twelfth) => (\n                  <option key={twelfth} value={twelfth}>\n                    {getNoteName(twelfth)}\n                  </option>\n                ))}\n            </select>\n            <select onChange={e => onChange({ octave: +e.target.value })} style={{ width: \"50%\" }} value={octave}>\n              {Array(11)\n                .fill(0)\n                .map((_, octave) => (\n                  <option key={octave} value={octave}>\n                    {octave}\n                  </option>\n                ))}\n            </select>\n          </div>\n          <div className=\"customNode_item\">\n            <select onChange={e => onChange({ type: e.target.value })} style={{ width: \"100%\" }} value={type}>\n              <option value=\"sawtooth\">sawtooth</option>\n              <option value=\"square\">square</option>\n              <option value=\"sine\">sine</option>\n              <option value=\"triangle\">triangle</option>\n            </select>\n          </div>\n        </div>\n      )}\n    </Node>\n  );\n}\n\nexport default React.memo(OscillatorNote);\n","import React, { useContext, useEffect, useMemo } from \"react\";\nimport { NodeProps } from \"react-flow-renderer\";\nimport { AudioContext } from \"context/AudioContext\";\nimport { useNode } from \"context/NodeContext\";\nimport Node from \"components/Node\";\n\nfunction StereoPanner({ data, id, selected, type }: NodeProps) {\n  const { pan = 0, onChange } = data;\n\n  // AudioNode\n  const context = useContext(AudioContext);\n  const node = useMemo<StereoPannerNode>(() => context.createStereoPanner(), [context]);\n  useNode(id, node);\n\n  // AudioParam\n  useEffect(() => void (node.pan.value = pan), [node, pan]);\n\n  return (\n    <Node\n      id={id}\n      inputs={[\"input\", \"pan\"]}\n      outputs={[\"output\"]}\n      title={`Stereo: ${Math.abs(pan * 100).toFixed(0)}% ${pan > 0 ? \"Right\" : pan < 0 ? \"Left\" : \"\"}`}\n      type={type}\n    >\n      {selected && (\n        <div className=\"customNode_editor\">\n          <div className=\"customNode_item\">\n            <input\n              className=\"nodrag\"\n              type=\"range\"\n              max=\"1\"\n              min=\"-1\"\n              step=\"0.01\"\n              onChange={e => onChange({ pan: +e.target.value })}\n              value={pan}\n            />\n          </div>\n        </div>\n      )}\n    </Node>\n  );\n}\n\nexport default React.memo(StereoPanner);\n","import React, { useCallback, useContext, useEffect, useMemo, useState } from \"react\";\nimport { NodeProps } from \"react-flow-renderer\";\nimport { AudioContext } from \"context/AudioContext\";\nimport { useNode } from \"context/NodeContext\";\nimport Node from \"components/Node\";\n\n// See: https://developer.mozilla.org/en-US/docs/Web/API/WaveShaperNode#Example\nconst distortion = `const k = 50;\nconst samples = curve.length;\nconst deg = Math.PI / 180;\nfor (let i = 0; i < samples; i++) {\n  const x = (i * 2) / samples - 1;\n  curve[i] = ((3 + k) * x * 20 * deg) / (Math.PI + k * Math.abs(x));\n}\nreturn curve;`;\n\nfunction WaveShaper({ data, id, selected, type }: NodeProps) {\n  const { onChange, oversample } = data;\n  const [curveFn, setCurveFn] = useState(data.curveFn ?? distortion);\n  const [lastValidCurveFn, setLastValidCurveFn] = useState(curveFn);\n\n  // AudioNode\n  const context = useContext(AudioContext);\n  const node = useMemo<WaveShaperNode>(() => context.createWaveShaper(), [context]);\n  useNode(id, node);\n\n  const curve = useMemo(() => {\n    const curve = new Float32Array(context.sampleRate);\n    // eslint-disable-next-line\n    return new Function(\"curve\", lastValidCurveFn)(curve);\n  }, [context.sampleRate, lastValidCurveFn]);\n\n  // AudioParam\n  useEffect(() => void (node.curve = curve), [node, curve]);\n  useEffect(() => void (node.oversample = oversample), [node, oversample]);\n\n  const updateCurve = useCallback(() => {\n    try {\n      // eslint-disable-next-line\n      new Function(\"curve\", curveFn)(new Float32Array(context.sampleRate));\n\n      setLastValidCurveFn(curveFn);\n      onChange({ curveFn });\n    } catch (e) {\n      console.error(e);\n    }\n  }, [context.sampleRate, curveFn, onChange]);\n\n  return (\n    <Node id={id} inputs={[\"input\"]} outputs={[\"output\"]} type={type}>\n      {selected && (\n        <div className=\"customNode_editor\">\n          <div className=\"customNode_item\" style={{ flexWrap: \"wrap\" }}>\n            <textarea\n              className=\"nodrag\"\n              onChange={e => setCurveFn(e.target.value)}\n              rows={8}\n              style={{ width: \"100%\" }}\n              value={curveFn}\n            />\n            <button onClick={updateCurve}>save</button>\n          </div>\n          <div className=\"customNode_item\">\n            <select onChange={e => onChange({ oversample: e.target.value })} value={oversample}>\n              <option value=\"none\">none</option>\n              <option value=\"2x\">2x</option>\n              <option value=\"4x\">4x</option>\n            </select>\n          </div>\n        </div>\n      )}\n    </Node>\n  );\n}\n\nexport default React.memo(WaveShaper);\n","import React, { useCallback, useState } from \"react\";\nimport ReactFlow, {\n  addEdge,\n  isEdge,\n  isNode,\n  removeElements,\n  useStoreState,\n  Background,\n  Connection,\n  Controls,\n  Edge,\n  Elements,\n  FlowTransform,\n  Node as ReactFlowNode,\n  OnLoadParams as ReactFlowInstance,\n} from \"react-flow-renderer\";\nimport { usePopper } from \"react-popper\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport produce from \"immer\";\nimport Analyser from \"components/nodes/Analyser\";\nimport BiquadFilter from \"components/nodes/BiquadFilter\";\nimport ChannelMerger from \"components/nodes/ChannelMerger\";\nimport ChannelSplitter from \"components/nodes/ChannelSplitter\";\nimport ConstantSource from \"components/nodes/ConstantSource\";\nimport Delay from \"components/nodes/Delay\";\nimport Destination from \"components/nodes/Destination\";\nimport DynamicsCompressor from \"components/nodes/DynamicsCompressor\";\nimport Gain from \"components/nodes/Gain\";\nimport Noise from \"components/nodes/Noise\";\nimport Oscillator from \"components/nodes/Oscillator\";\nimport OscillatorNote from \"components/nodes/OscillatorNote\";\nimport StereoPanner from \"components/nodes/StereoPanner\";\nimport WaveShaper from \"components/nodes/WaveShaper\";\nimport { useOnConnect, useOnEdgeRemove, useOnNodeRemove } from \"utils/handles\";\nimport { useNodeContext } from \"context/NodeContext\";\n\ninterface Props {\n  elements: Elements;\n  transform: FlowTransform;\n}\n\nconst nodeTypes = {\n  Analyser: Analyser,\n  BiquadFilter: BiquadFilter,\n  ChannelMerger: ChannelMerger,\n  ChannelSplitter: ChannelSplitter,\n  ConstantSource: ConstantSource,\n  Delay: Delay,\n  Destination: Destination,\n  DynamicsCompressor: DynamicsCompressor,\n  Gain: Gain,\n  Noise: Noise,\n  Oscillator: Oscillator,\n  OscillatorNote: OscillatorNote,\n  StereoPanner: StereoPanner,\n  WaveShaper: WaveShaper,\n};\n\nasync function waitForInitialNodes(initialElements: Elements, audioNodes: Record<string, AudioNode>) {\n  const nodesWithConnections = initialElements.filter(isEdge).reduce<Record<string, boolean>>((nodeIds, edge) => {\n    nodeIds[edge.source] = true;\n    nodeIds[edge.target] = true;\n    return nodeIds;\n  }, {});\n  while (Object.keys(nodesWithConnections).length) {\n    Object.keys(audioNodes).forEach(nodeId => {\n      delete nodesWithConnections[nodeId];\n    });\n    await new Promise(resolve => setTimeout(resolve, 0));\n  }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n}\n\nconst GRID_SIZE = 10;\n\nfunction snapToGrid(position: number) {\n  return Math.floor(position / GRID_SIZE) * GRID_SIZE;\n}\n\nfunction Flow({ elements: initialElements, transform: initialTransform }: Props) {\n  const [showPopper, setShowPopper] = React.useState(false);\n  const [popperElement, setPopperElement] = React.useState<HTMLDivElement>();\n  const [virtualReference, setVirtualReference] = React.useState<any>(null);\n  const { styles, attributes } = usePopper(virtualReference, popperElement, {\n    placement: \"bottom-start\",\n  });\n  const transform = useStoreState(store => store.transform);\n\n  const [elements, setElements] = useState<Elements>(initialElements);\n  const { nodes: audioNodes } = useNodeContext();\n\n  const onElementsConnect = useOnConnect();\n  const onEdgeRemove = useOnEdgeRemove();\n  const onNodeRemove = useOnNodeRemove();\n\n  const createOnChange = (id: string) => (data: Record<string, any>): void => {\n    setElements(\n      produce((draft: Elements) => {\n        const node = draft.filter(isNode).find(element => element.id === id);\n        if (!node) {\n          return;\n        }\n        Object.keys(data).forEach(property => (node.data[property] = data[property]));\n      })\n    );\n  };\n\n  const onLoad = async (reactFlowInstance: ReactFlowInstance) => {\n    reactFlowInstance.setTransform(initialTransform);\n\n    // Attach onChange to nodes\n    setElements(\n      produce((draft: Elements) => {\n        draft.filter(isNode).forEach(node => {\n          node.data.onChange = createOnChange(node.id);\n        });\n      })\n    );\n\n    // Wait for nodes to render and handle connections\n    // FIXME This should be handled on changes to ReactFlowRenderer state instead.\n    await waitForInitialNodes(initialElements, audioNodes);\n    const edges = initialElements.filter(isEdge);\n    edges.forEach(edge => onElementsConnect(edge));\n  };\n\n  const onConnect = (params: Edge | Connection) => {\n    const edge = Object.assign({}, params, {\n      style: {\n        stroke: params.source ? `#${params.source.substr(-6)}` : undefined,\n      },\n    });\n    setElements(elements => addEdge(edge, elements));\n    onElementsConnect(params);\n  };\n  const onElementsRemove = useCallback(\n    (elementsToRemove: Elements) => {\n      elementsToRemove.filter(isEdge).forEach(edge => onEdgeRemove(edge));\n      elementsToRemove.filter(isNode).forEach(node => onNodeRemove(node.id));\n\n      setElements(elements => removeElements(elementsToRemove, elements));\n    },\n    [onEdgeRemove, onNodeRemove]\n  );\n  const onEdgeUpdate = (oldEdge: Edge, newConnection: Connection) => {\n    onEdgeRemove(oldEdge);\n    setElements(elements => removeElements([oldEdge], elements));\n    setElements(elements => addEdge(newConnection, elements));\n    onElementsConnect(newConnection);\n  };\n\n  const onNodeDragStop = (event: React.MouseEvent<Element, MouseEvent>, draggedNode: ReactFlowNode) => {\n    setElements(\n      produce((draft: Elements) => {\n        const node = draft.filter(isNode).find(element => element.id === draggedNode.id);\n        if (!node) {\n          return;\n        }\n        node.position = {\n          x: snapToGrid(draggedNode.position.x),\n          y: snapToGrid(draggedNode.position.y),\n        };\n      })\n    );\n  };\n\n  const onPaneClick = (event: React.MouseEvent<Element, MouseEvent>) => {\n    setShowPopper(!!popperElement?.contains(event.target as Node));\n  };\n\n  const onPaneContextMenu = (event: React.MouseEvent<Element, MouseEvent>) => {\n    event.preventDefault();\n    setShowPopper(true);\n    setVirtualReference({\n      getBoundingClientRect: () => ({\n        top: event.clientY,\n        left: event.clientX,\n        height: 0,\n        width: 0,\n      }),\n    });\n  };\n\n  const addNode = useCallback(\n    (type: string) => {\n      const id = `${type}-${uuidv4()}`;\n      const onChange = createOnChange(id);\n      const position = {\n        x: snapToGrid((virtualReference.getBoundingClientRect().left - transform[0]) / transform[2]),\n        y: snapToGrid((virtualReference.getBoundingClientRect().top - transform[1]) / transform[2]),\n      };\n      const node = {\n        id,\n        data: { onChange },\n        type,\n        position,\n      };\n      setElements(elements => [...elements, node]);\n      setShowPopper(false);\n    },\n    [transform, virtualReference]\n  );\n\n  return (\n    <>\n      <ReactFlow\n        defaultPosition={[initialTransform.x, initialTransform.y]}\n        defaultZoom={initialTransform.zoom}\n        elements={elements}\n        nodeTypes={nodeTypes}\n        onConnect={onConnect}\n        onEdgeUpdate={onEdgeUpdate}\n        onElementsRemove={onElementsRemove}\n        onLoad={onLoad}\n        onNodeDragStop={onNodeDragStop}\n        onPaneClick={onPaneClick}\n        onPaneContextMenu={onPaneContextMenu}\n        onlyRenderVisibleElements={false}\n        snapToGrid\n        snapGrid={[GRID_SIZE, GRID_SIZE]}\n        // TODO figure out why this is needed for flow container not to cover context menu\n        style={{ zIndex: 0 }}\n      >\n        <Background gap={GRID_SIZE} />\n        <Controls />\n      </ReactFlow>\n      {/* TODO extract as ContextMenu component */}\n      {showPopper && (\n        <div ref={node => node && setPopperElement(node)} style={styles.popper} {...attributes.popper}>\n          <ul className=\"contextMenu\">\n            <li onClick={() => addNode(\"Analyser\")}>Add Analyser</li>\n            <li onClick={() => addNode(\"BiquadFilter\")}>Add Biquad Filter</li>\n            <li onClick={() => addNode(\"ChannelMerger\")}>Add Channel Merger</li>\n            <li onClick={() => addNode(\"ChannelSplitter\")}>Add Channel Splitter</li>\n            <li onClick={() => addNode(\"ConstantSource\")}>Add Constant Source</li>\n            <li onClick={() => addNode(\"Delay\")}>Add Delay</li>\n            <li onClick={() => addNode(\"Destination\")}>Add Destination</li>\n            <li onClick={() => addNode(\"DynamicsCompressor\")}>Add Dynamics Compressor</li>\n            <li onClick={() => addNode(\"Gain\")}>Add Gain</li>\n            <li onClick={() => addNode(\"Noise\")}>Add Noise</li>\n            <li onClick={() => addNode(\"Oscillator\")}>Add Oscillator</li>\n            <li onClick={() => addNode(\"OscillatorNote\")}>Add Oscillator Note</li>\n            <li onClick={() => addNode(\"StereoPanner\")}>Add Stereo Panner</li>\n            <li onClick={() => addNode(\"WaveShaper\")}>Add Wave Shaper</li>\n          </ul>\n        </div>\n      )}\n    </>\n  );\n}\n\nexport default React.memo(Flow);\n","import React, { Dispatch, SetStateAction, useCallback, useEffect, useMemo, useState } from \"react\";\nimport { useStoreState, Elements, FlowTransform } from \"react-flow-renderer\";\nimport { v4 as uuidv4 } from \"uuid\";\n\ninterface Props {\n  setProject: Dispatch<SetStateAction<ProjectState>>;\n}\n\nexport interface ProjectState {\n  elements: Elements;\n  id: string;\n  transform: FlowTransform;\n}\n\nconst textareaStyles: React.CSSProperties = {\n  fontSize: 12,\n  height: \"100%\",\n  resize: \"none\",\n  width: \"100%\",\n};\n\nconst controlsStyles: React.CSSProperties = {\n  display: \"flex\",\n  position: \"absolute\",\n  right: \"100%\",\n  top: -10,\n  transform: \"rotate(-90deg)\",\n  transformOrigin: \"bottom right\",\n};\n\nconst getDrawerStyles = (visible: boolean): React.CSSProperties => ({\n  height: \"100%\",\n  padding: 10,\n  position: \"absolute\",\n  right: 0,\n  top: 0,\n  transform: visible ? \"translateX(0)\" : \"translateX(100%)\",\n  transition: \"transform 0.4s ease\",\n  width: 400,\n});\n\nexport const getDefaultProject = () => ({\n  id: uuidv4(),\n  elements: [],\n  transform: {\n    x: 0,\n    y: 0,\n    zoom: 1,\n  },\n});\n\nfunction Project({ setProject }: Props) {\n  const [visible, setVisible] = useState(false);\n  const elements = useStoreState(store => store.elements);\n  const transform = useStoreState(store => store.transform);\n  const mappedElements = elements.map(element => ({\n    ...element,\n    __rf: undefined,\n  }));\n  const mappedTransform = {\n    x: transform[0],\n    y: transform[1],\n    zoom: transform[2],\n  };\n  const project = JSON.stringify({\n    elements: mappedElements,\n    transform: mappedTransform,\n  });\n  const drawerStyles = useMemo(() => getDrawerStyles(visible), [visible]);\n\n  // Load project from URL\n  useEffect(() => {\n    const project = atob(window.location.hash.substr(1));\n    try {\n      const { elements, transform } = JSON.parse(project);\n      setProject({\n        elements,\n        id: uuidv4(),\n        transform,\n      });\n    } catch (e) {\n      console.error(e);\n    }\n  }, [setProject]);\n\n  // Store project in URL\n  useEffect(() => {\n    window.location.hash = btoa(project);\n  }, [project]);\n\n  const onChange = useCallback(\n    (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n      try {\n        const { elements, transform } = JSON.parse(e.target.value);\n        setProject({\n          elements,\n          id: uuidv4(),\n          transform,\n        });\n      } catch (e) {\n        console.error(e);\n      }\n    },\n    [setProject]\n  );\n\n  const clearProject = useCallback(() => {\n    setProject(getDefaultProject);\n  }, [setProject]);\n  const toggleProjectDrawer = useCallback(() => setVisible(visible => !visible), []);\n\n  return (\n    <div style={drawerStyles}>\n      <textarea\n        onChange={onChange}\n        style={textareaStyles}\n        value={JSON.stringify(\n          {\n            elements: mappedElements,\n            transform: mappedTransform,\n          },\n          null,\n          2\n        )}\n      />\n      <div style={controlsStyles}>\n        <button onClick={clearProject} style={{ marginRight: 10 }}>\n          clear\n        </button>\n        <button onClick={toggleProjectDrawer}>{visible ? \"hide\" : \"show\"}</button>\n      </div>\n    </div>\n  );\n}\n\nexport default Project;\n","import React, { useState } from \"react\";\nimport { ReactFlowProvider } from \"react-flow-renderer\";\nimport Audio from \"components/Audio\";\nimport Flow from \"components/Flow\";\nimport Project, { ProjectState, getDefaultProject } from \"components/Project\";\nimport Nodes from \"components/Nodes\";\n\nfunction App() {\n  const [project, setProject] = useState<ProjectState>(getDefaultProject);\n\n  return (\n    <Audio>\n      <ReactFlowProvider>\n        <Nodes>\n          <div\n            style={{\n              alignItems: \"stretch\",\n              display: \"flex\",\n              height: \"100vh\",\n            }}\n          >\n            <Flow key={project.id} elements={project.elements} transform={project.transform} />\n            <Project setProject={setProject} />\n          </div>\n        </Nodes>\n      </ReactFlowProvider>\n    </Audio>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}