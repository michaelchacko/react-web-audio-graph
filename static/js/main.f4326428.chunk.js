(this["webpackJsonpreact-web-audio-graph"]=this["webpackJsonpreact-web-audio-graph"]||[]).push([[0],{25:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n(0),r=n.n(a),i=n(7),o=n.n(i),u=(n(25),n(3)),s=n(2),l=Object(a.createContext)(null);var d=function(e){var t=e.children,n=Object(a.useMemo)((function(){try{return window.AudioContext||(window.AudioContext=window.webkitAudioContext),new window.AudioContext}catch(e){}}),[]),r=Object(a.useCallback)((function(){"suspended"===(null===n||void 0===n?void 0:n.state)&&n.resume()}),[n]);return n?Object(c.jsx)("div",{onClick:r,children:Object(c.jsx)(l.Provider,{value:n,children:t})}):Object(c.jsx)("div",{children:"Sorry, but the Web Audio API is not supported by your browser."})},j=n(4),f=n(15),b=n(5),m=n.n(b),v=n(12),O=n(34),h=n(35),p=n(10),x=Object(a.createContext)(null);function g(){return Object(a.useContext)(x)}function y(e,t){var n=g(),c=n.addNode,r=n.removeNode;Object(a.useEffect)((function(){return c(e,t),function(){r(e)}}),[c,t,e,r])}var C=n(16);function N(e){var t=e.node,n=e.paused,r=e.type,i=Object(C.a)(e,["node","paused","type"]),o=Object(a.useRef)(new Uint8Array(t.frequencyBinCount)),u=Object(a.useRef)(null),s=Object(a.useCallback)((function(){var e=u.current,t=null===e||void 0===e?void 0:e.getContext("2d");e&&t&&(r===E.TimeDomain?function(e,t){var n=0,c=e.canvas.height,a=e.canvas.width,r=t.length,i=a/r;e.fillStyle="#001400",e.fillRect(0,0,a,256),e.lineWidth=2,e.strokeStyle="#00c800",e.beginPath(),e.moveTo(n,c-t[0]/128*c/2);for(var o=1;o<r;o++){var u=t[o]/128*c/2;e.lineTo(n,c-u),n+=i}e.stroke()}(t,o.current):r===E.Frequency&&function(e,t){var n=0,c=e.canvas.height,a=e.canvas.width,r=t.length,i=a/r;e.fillStyle="#001400",e.fillRect(0,0,a,256),e.fillStyle="#00c800";for(var o=0;o<r;o++){var u=c*(t[o]/255),s=c-u;e.fillRect(n,s,i,u),n+=i}}(t,o.current))}),[r]),l=Object(a.useCallback)((function(){var e=t.frequencyBinCount,n=new Uint8Array(e);r===E.TimeDomain?t.getByteTimeDomainData(n):r===E.Frequency&&t.getByteFrequencyData(n),o.current=n}),[t,r]);return function(e,t){var n=Object(a.useRef)(),c=Object(a.useRef)(),r=null===t||void 0===t?void 0:t.maxFPS,i=Object(a.useCallback)((function(t){if(null!=n.current){var a=t-n.current;(!r||a>1e3/r)&&(e(a),n.current=t)}else e(0),n.current=t;c.current=requestAnimationFrame(i)}),[e]);Object(a.useEffect)((function(){return c.current=requestAnimationFrame(i),function(){null!=c.current&&cancelAnimationFrame(c.current)}}),[i])}(Object(a.useCallback)((function(){n||(l(),s())}),[s,l,n])),Object(c.jsx)("canvas",Object(j.a)({ref:u,style:{display:"block"}},i))}var w=r.a.memo(N);function k(e){var t=e.children,n=e.id,a=e.inputs,r=e.outputs,i=e.title,o=e.type;return Object(c.jsxs)("div",{className:"customNode",title:n,children:[Object(c.jsx)("div",{className:"customNode_header",children:null!==i&&void 0!==i?i:o}),Object(c.jsxs)("div",{className:"customNode_body",children:[a&&Object(c.jsx)("div",{className:"customNode_inputs",children:a.map((function(e){return Object(c.jsxs)("div",{className:"customNode_item",children:[Object(c.jsx)(s.c,{id:e,position:s.d.Left,type:"target"}),e]},e)}))}),r&&Object(c.jsx)("div",{className:"customNode_outputs",children:r.map((function(e){return Object(c.jsxs)("div",{className:"customNode_item",children:[Object(c.jsx)(s.c,{id:e,position:s.d.Right,type:"source"}),e]},e)}))})]}),t]})}var E,S=r.a.memo(k);function _(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.fftSizeExp,u=void 0===o?11:o,s=t.onChange,d=t.paused,j=void 0!==d&&d,f=t.type,b=void 0===f?E.TimeDomain:f,m=Object(a.useContext)(l),v=Object(a.useMemo)((function(){return m.createAnalyser()}),[m]);return y(n,v),Object(a.useEffect)((function(){v.fftSize=Math.pow(2,u)}),[v,u]),Object(c.jsxs)(S,{id:n,inputs:["input","fftSize"],outputs:["output"],title:"Analyser: ".concat(b),type:i,children:[Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)(w,{type:b,node:v,paused:j,height:64,width:256})}),r&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsxs)("div",{className:"customNode_item",children:[Object(c.jsx)("input",{className:"nodrag",type:"range",max:"11",min:"5",onChange:function(e){return s({fftSizeExp:+e.target.value})},step:1,value:u}),Math.pow(2,u)]}),Object(c.jsxs)("div",{className:"customNode_item",style:{justifyContent:"space-between"},children:[Object(c.jsxs)("select",{onChange:function(e){return s({type:e.target.value})},value:b,children:[Object(c.jsx)("option",{value:E.Frequency,children:E.Frequency}),Object(c.jsx)("option",{value:E.TimeDomain,children:E.TimeDomain})]}),Object(c.jsxs)("label",{style:{alignItems:"center",display:"flex"},children:[Object(c.jsx)("input",{className:"nodrag",type:"checkbox",checked:j,onChange:function(e){return s({paused:!j})}}),"Paused"]})]})]})]})}!function(e){e.Frequency="Frequency",e.TimeDomain="Time Domain"}(E||(E={}));var A=r.a.memo(_);function M(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.detune,u=void 0===o?0:o,s=t.gain,d=void 0===s?0:s,j=t.frequency,f=void 0===j?350:j,b=t.Q,m=void 0===b?1:b,v=t.onChange,O=t.type,h=void 0===O?"lowpass":O,p=Object(a.useContext)(l),x=Object(a.useMemo)((function(){return p.createBiquadFilter()}),[p]);return y(n,x),Object(a.useEffect)((function(){x.detune.value=u}),[x,u]),Object(a.useEffect)((function(){x.frequency.value=f}),[x,f]),Object(a.useEffect)((function(){x.gain.value=d}),[x,d]),Object(a.useEffect)((function(){x.Q.value=m}),[x,m]),Object(a.useEffect)((function(){x.type=h}),[x,h]),Object(c.jsx)(S,{id:n,inputs:["input","detune","frequency","gain","Q"],outputs:["output"],title:"Filter: ".concat(h),type:i,children:r&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:-100,max:100,onChange:function(e){return v({detune:+e.target.value})},step:1,type:"range",value:u})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:0,max:22050,onChange:function(e){return v({frequency:+e.target.value})},type:"number",value:f})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:-40,max:40,onChange:function(e){return v({gain:+e.target.value})},step:.1,type:"range",value:d})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:1e-4,max:1e3,onChange:function(e){return v({Q:+e.target.value})},type:"number",value:m})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsxs)("select",{onChange:function(e){return v({type:e.target.value})},value:h,children:[Object(c.jsx)("option",{value:"lowpass",children:"lowpass"}),Object(c.jsx)("option",{value:"highpass",children:"highpass"}),Object(c.jsx)("option",{value:"bandpass",children:"bandpass"}),Object(c.jsx)("option",{value:"lowshelf",children:"lowshelf"}),Object(c.jsx)("option",{value:"highshelf",children:"highshelf"}),Object(c.jsx)("option",{value:"peaking",children:"peaking"}),Object(c.jsx)("option",{value:"notch",children:"notch"}),Object(c.jsx)("option",{value:"allpass",children:"allpass"})]})})]})})}var F=r.a.memo(M);function q(e){var t=e.id,n=e.type,r=Object(a.useContext)(l),i=Object(a.useMemo)((function(){return r.createChannelMerger(2)}),[r]);return y(t,i),Object(c.jsx)(S,{id:t,inputs:Array(i.numberOfInputs).fill(0).map((function(e,t){return"input-".concat(t)})),outputs:["output"],type:n})}var D=r.a.memo(q);function R(e){var t=e.id,n=e.type,r=Object(a.useContext)(l),i=Object(a.useMemo)((function(){return r.createChannelSplitter(2)}),[r]);return y(t,i),Object(c.jsx)(S,{id:t,inputs:["input"],outputs:Array(i.numberOfOutputs).fill(0).map((function(e,t){return"output-".concat(t)})),type:n})}var P=r.a.memo(R);function T(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.offset,u=void 0===o?1:o,s=t.onChange,d=Object(a.useContext)(l),j=Object(a.useMemo)((function(){return d.createConstantSource()}),[d]);return Object(a.useEffect)((function(){return j.start(),function(){return j.stop()}}),[j]),y(n,j),Object(a.useEffect)((function(){return j.offset.value=u}),[j,u]),Object(c.jsx)(S,{id:n,outputs:["output"],title:"Constant: ".concat(u),type:i,children:r&&Object(c.jsx)("div",{className:"customNode_editor",children:Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"number",onChange:function(e){return s({offset:+e.target.value})},style:{width:"100%"},value:u})})})})}var B=r.a.memo(T);function z(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.delayTime,u=void 0===o?1:o,s=t.onChange,d=Object(a.useContext)(l),j=Object(a.useMemo)((function(){return d.createDelay()}),[d]);return y(n,j),Object(a.useEffect)((function(){j.delayTime.value=u}),[j,u]),Object(c.jsx)(S,{id:n,inputs:["input","delayTime"],outputs:["output"],title:"Delay: ".concat(u," s"),type:i,children:r&&Object(c.jsx)("div",{className:"customNode_editor",children:Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"number",onChange:function(e){return s({delayTime:+e.target.value})},value:u})})})})}var H=r.a.memo(z);function G(e){var t=e.id,n=e.type;return y(t,Object(a.useContext)(l).destination),Object(c.jsx)(S,{id:t,inputs:["input"],type:n})}var I=r.a.memo(G);function W(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.attack,u=void 0===o?.003:o,s=t.knee,d=void 0===s?30:s,j=t.onChange,f=t.ratio,b=void 0===f?12:f,m=t.release,v=void 0===m?.25:m,O=t.threshold,h=void 0===O?-24:O,p=Object(a.useContext)(l),x=Object(a.useMemo)((function(){return p.createDynamicsCompressor()}),[p]);return y(n,x),Object(a.useEffect)((function(){x.threshold.value=h}),[x,h]),Object(a.useEffect)((function(){x.knee.value=d}),[x,d]),Object(a.useEffect)((function(){x.ratio.value=b}),[x,b]),Object(a.useEffect)((function(){x.attack.value=u}),[x,u]),Object(a.useEffect)((function(){x.release.value=v}),[x,v]),Object(c.jsx)(S,{id:n,inputs:["input","threshold","knee","ratio","attack","release"],outputs:["output"],type:i,children:r&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"0",min:"-100",step:"1",onChange:function(e){return j({threshold:+e.target.value})},value:h})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"40",min:"0",step:"1",onChange:function(e){return j({knee:+e.target.value})},value:d})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"20",min:"1",step:"1",onChange:function(e){return j({ratio:+e.target.value})},value:b})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"1",min:"0",step:"0.001",onChange:function(e){return j({attack:+e.target.value})},value:u})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"1",min:"0",step:"0.001",onChange:function(e){return j({release:+e.target.value})},value:v})})]})})}var J=r.a.memo(W);function L(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.gain,u=void 0===o?1:o,s=t.onChange,d=Object(a.useContext)(l),j=Object(a.useMemo)((function(){return d.createGain()}),[d]);return y(n,j),Object(a.useEffect)((function(){j.gain.value=u}),[j,u]),Object(c.jsx)(S,{id:n,inputs:["input","gain"],outputs:["output"],title:"Gain: ".concat(u),type:i,children:r&&Object(c.jsx)("div",{className:"customNode_editor",children:Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"1",min:"-1",step:"0.01",onChange:function(e){return s({gain:+e.target.value})},value:u})})})})}var Q=r.a.memo(L);function X(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.detune,u=void 0===o?0:o,s=t.frequency,d=void 0===s?440:s,j=t.onChange,f=t.type,b=void 0===f?"sine":f,m=Object(a.useContext)(l),v=Object(a.useMemo)((function(){return m.createOscillator()}),[m]);return Object(a.useEffect)((function(){return v.start(),function(){return v.stop()}}),[v]),y(n,v),Object(a.useEffect)((function(){v.detune.value=null!==u&&void 0!==u?u:0}),[v,u]),Object(a.useEffect)((function(){v.frequency.value=null!==d&&void 0!==d?d:440}),[v,d]),Object(a.useEffect)((function(){v.type=null!==b&&void 0!==b?b:"sine"}),[v,b]),Object(c.jsx)(S,{id:n,inputs:["detune","frequency"],outputs:["output"],title:"".concat(d," Hz ").concat(b),type:i,children:r&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:-100,max:100,onChange:function(e){return j({detune:+e.target.value})},step:1,type:"number",value:u})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:0,max:2e4,onChange:function(e){return j({frequency:+e.target.value})},type:"number",value:d})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsxs)("select",{onChange:function(e){return j({type:e.target.value})},value:b,children:[Object(c.jsx)("option",{value:"sawtooth",children:"sawtooth"}),Object(c.jsx)("option",{value:"square",children:"square"}),Object(c.jsx)("option",{value:"sine",children:"sine"}),Object(c.jsx)("option",{value:"triangle",children:"triangle"})]})})]})})}var U=r.a.memo(X),V=["C","C\u266f","D","D\u266f","E","F","F\u266f","G","G\u266f","A","A\u266f","B"];function Y(e){if(e<0||e>11)throw new RangeError("Octave must be between 0 and 11, is ".concat(e))}function Z(e,t){!function(e){if(e<0||e>10)throw new RangeError("Octave must be between 0 and 10, is ".concat(e))}(e),Y(t);return 16.3516*Math.pow(2,e+t/12)}function $(e){return Y(e),V[e]}var K={display:"inline-block",textAlign:"center",width:7},ee=Object(j.a)(Object(j.a)({},K),{},{verticalAlign:"sub"}),te=Object(j.a)(Object(j.a)({},K),{},{transform:"translateX(-100%)",verticalAlign:"super"});function ne(e){var t=e.octave,n=e.twelfth,a=$(n).split(""),r=Object(u.a)(a,2),i=r[0],o=r[1],s=Z(t,n);return Object(c.jsxs)("span",{children:[i,Object(c.jsx)("small",{style:ee,children:t}),o&&Object(c.jsx)("small",{style:te,children:o}),Object(c.jsxs)("small",{children:[" (",s.toFixed(2)," Hz)"]})]})}var ce=r.a.memo(ne);function ae(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.detune,u=void 0===o?0:o,s=t.octave,d=void 0===s?4:s,j=t.onChange,f=t.twelfth,b=void 0===f?0:f,m=t.type,v=void 0===m?"sine":m,O=Z(d,b),h=Object(a.useContext)(l),p=Object(a.useMemo)((function(){return h.createOscillator()}),[h]);return Object(a.useEffect)((function(){return p.start(),function(){return p.stop()}}),[p]),y(n,p),Object(a.useEffect)((function(){p.detune.value=null!==u&&void 0!==u?u:0}),[p,u]),Object(a.useEffect)((function(){p.frequency.value=O}),[p,O]),Object(a.useEffect)((function(){p.type=null!==v&&void 0!==v?v:"sine"}),[p,v]),Object(c.jsx)(S,{id:n,inputs:["detune"],outputs:["output"],title:Object(c.jsx)(ce,{octave:d,twelfth:b}),type:i,children:r&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:-100,max:100,onChange:function(e){return j({detune:+e.target.value})},step:1,style:{width:"100%"},type:"range",value:u})}),Object(c.jsxs)("div",{className:"customNode_item",children:[Object(c.jsx)("select",{onChange:function(e){return j({twelfth:+e.target.value})},style:{width:"50%"},value:b,children:Array(12).fill(0).map((function(e,t){return Object(c.jsx)("option",{value:t,children:$(t)},t)}))}),Object(c.jsx)("select",{onChange:function(e){return j({octave:+e.target.value})},style:{width:"50%"},value:d,children:Array(11).fill(0).map((function(e,t){return Object(c.jsx)("option",{value:t,children:t},t)}))})]}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsxs)("select",{onChange:function(e){return j({type:e.target.value})},style:{width:"100%"},value:v,children:[Object(c.jsx)("option",{value:"sawtooth",children:"sawtooth"}),Object(c.jsx)("option",{value:"square",children:"square"}),Object(c.jsx)("option",{value:"sine",children:"sine"}),Object(c.jsx)("option",{value:"triangle",children:"triangle"})]})})]})})}function re(e){var t=e.data,n=e.id,r=e.selected,i=e.type,o=t.pan,u=void 0===o?0:o,s=t.onChange,d=Object(a.useContext)(l),j=Object(a.useMemo)((function(){return d.createStereoPanner()}),[d]);return y(n,j),Object(a.useEffect)((function(){j.pan.value=u}),[j,u]),Object(c.jsx)(S,{id:n,inputs:["input","pan"],outputs:["output"],title:"Stereo: ".concat(Math.abs(100*u).toFixed(0),"% ").concat(u>0?"Right":u<0?"Left":""),type:i,children:r&&Object(c.jsx)("div",{className:"customNode_editor",children:Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"1",min:"-1",step:"0.01",onChange:function(e){return s({pan:+e.target.value})},value:u})})})})}function ie(e){var t,n=e.data,r=e.id,i=e.selected,o=e.type,s=n.onChange,d=n.oversample,j=Object(a.useState)(null!==(t=n.curveFn)&&void 0!==t?t:"const k = 50;\nconst samples = curve.length;\nconst deg = Math.PI / 180;\nfor (let i = 0; i < samples; i++) {\n  const x = (i * 2) / samples - 1;\n  curve[i] = ((3 + k) * x * 20 * deg) / (Math.PI + k * Math.abs(x));\n}\nreturn curve;"),f=Object(u.a)(j,2),b=f[0],m=f[1],v=Object(a.useState)(b),O=Object(u.a)(v,2),h=O[0],p=O[1],x=Object(a.useContext)(l),g=Object(a.useMemo)((function(){return x.createWaveShaper()}),[x]);y(r,g);var C=Object(a.useMemo)((function(){var e=new Float32Array(x.sampleRate);return new Function("curve",h)(e)}),[x.sampleRate,h]);Object(a.useEffect)((function(){g.curve=C}),[g,C]),Object(a.useEffect)((function(){g.oversample=d}),[g,d]);var N=Object(a.useCallback)((function(){try{new Function("curve",b)(new Float32Array(x.sampleRate)),p(b),s({curveFn:b})}catch(e){console.error(e)}}),[x.sampleRate,b,s]);return Object(c.jsx)(S,{id:r,inputs:["input"],outputs:["output"],type:o,children:i&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsxs)("div",{className:"customNode_item",style:{flexWrap:"wrap"},children:[Object(c.jsx)("textarea",{className:"nodrag",onChange:function(e){return m(e.target.value)},rows:8,style:{width:"100%"},value:b}),Object(c.jsx)("button",{onClick:N,children:"save"})]}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsxs)("select",{onChange:function(e){return s({oversample:e.target.value})},value:d,children:[Object(c.jsx)("option",{value:"none",children:"none"}),Object(c.jsx)("option",{value:"2x",children:"2x"}),Object(c.jsx)("option",{value:"4x",children:"4x"})]})})]})})}function oe(e){var t,n;return+(null!==(t=null===(n=e.match(/-(\d+)$/))||void 0===n?void 0:n[1])&&void 0!==t?t:0)}var ue={Analyser:A,BiquadFilter:F,ChannelMerger:D,ChannelSplitter:P,ConstantSource:B,Delay:H,Destination:I,DynamicsCompressor:J,Gain:Q,Oscillator:U,OscillatorNote:r.a.memo(ae),StereoPanner:r.a.memo(re),WaveShaper:r.a.memo(ie)};function se(e,t){return le.apply(this,arguments)}function le(){return(le=Object(v.a)(m.a.mark((function e(t,n){var c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=t.filter(s.h).reduce((function(e,t){return e[t.source]=!0,e[t.target]=!0,e}),{});case 1:if(!Object.keys(c).length){e.next=7;break}return Object.keys(n).forEach((function(e){delete c[e]})),e.next=5,new Promise((function(e){return setTimeout(e,0)}));case 5:e.next=1;break;case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(e){var t=e.elements,n=e.transform,i=r.a.useState(!1),o=Object(u.a)(i,2),l=o[0],d=o[1],b=r.a.useState(),x=Object(u.a)(b,2),y=x[0],C=x[1],N=r.a.useState(null),w=Object(u.a)(N,2),k=w[0],E=w[1],S=Object(O.a)(k,y,{placement:"bottom-start"}),_=S.styles,A=S.attributes,M=Object(s.k)((function(e){return e.transform})),F=Object(a.useState)(t),q=Object(u.a)(F,2),D=q[0],R=q[1],P=g().nodes,T=function(){var e=g().nodes;return Object(a.useCallback)((function(t){if(console.log("Connection created",t),t.source&&t.target&&t.sourceHandle&&t.targetHandle){var n=e[t.source],c=e[t.target],a=t.sourceHandle,r=t.targetHandle,i=oe(a),o=oe(r);r.startsWith("input")?n.connect(c,i,o):n.connect(c[r],i)}}),[e])}(),B=function(){var e=g().nodes;return Object(a.useCallback)((function(t){if(console.log("Connection removed",t),t.source&&t.target&&t.sourceHandle&&t.targetHandle){var n=e[t.source],c=e[t.target],a=t.sourceHandle,r=t.targetHandle,i=oe(a),o=oe(r);r.startsWith("input")?n.disconnect(c,i,o):n.disconnect(c[r],i)}}),[e])}(),z=function(){var e=g().nodes;return Object(a.useCallback)((function(t){console.log("Node removed",t,e);var n=e[t];n&&n.disconnect()}),[e])}(),H=function(e){return function(t){R(Object(p.a)((function(n){var c=n.filter(s.i).find((function(t){return t.id===e}));c&&Object.keys(t).forEach((function(e){return c.data[e]=t[e]}))})))}},G=function(){var e=Object(v.a)(m.a.mark((function e(c){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.setTransform(n),R(Object(p.a)((function(e){e.filter(s.i).forEach((function(e){e.data.onChange=H(e.id)}))}))),e.next=4,se(t,P);case 4:t.filter(s.h).forEach((function(e){return T(e)}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=Object(a.useCallback)((function(e){e.filter(s.h).forEach((function(e){return B(e)})),e.filter(s.i).forEach((function(e){return z(e.id)})),R((function(t){return Object(s.j)(e,t)}))}),[B,z]),W=Object(a.useCallback)((function(e){var t="".concat(e,"-").concat(Object(h.a)()),n={id:t,data:{onChange:H(t)},type:e,position:{x:(k.getBoundingClientRect().left-M[0])/M[2],y:(k.getBoundingClientRect().top-M[1])/M[2]}};R((function(e){return[].concat(Object(f.a)(e),[n])})),d(!1)}),[M,k]);return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)(s.g,{defaultPosition:[n.x,n.y],defaultZoom:n.zoom,elements:D,nodeTypes:ue,onConnect:function(e){R((function(t){return Object(s.f)(e,t)})),T(e)},onEdgeUpdate:function(e,t){B(e),R((function(t){return Object(s.j)([e],t)})),R((function(e){return Object(s.f)(t,e)})),T(t)},onElementsRemove:I,onLoad:G,onNodeDragStop:function(e,t){R(Object(p.a)((function(e){var n=e.filter(s.i).find((function(e){return e.id===t.id}));n&&(n.position=t.position)})))},onPaneClick:function(e){d(!!(null===y||void 0===y?void 0:y.contains(e.target)))},onPaneContextMenu:function(e){e.preventDefault(),d(!0),E({getBoundingClientRect:function(){return{top:10*Math.floor(e.clientY/10),left:10*Math.floor(e.clientX/10),height:0,width:0}}})},onlyRenderVisibleElements:!1,snapToGrid:!0,snapGrid:[10,10],style:{zIndex:0},children:[Object(c.jsx)(s.a,{gap:10}),Object(c.jsx)(s.b,{})]}),l&&Object(c.jsx)("div",Object(j.a)(Object(j.a)({ref:function(e){return e&&C(e)},style:_.popper},A.popper),{},{children:Object(c.jsxs)("ul",{className:"contextMenu",children:[Object(c.jsx)("li",{onClick:function(){return W("Analyser")},children:"Add Analyser"}),Object(c.jsx)("li",{onClick:function(){return W("BiquadFilter")},children:"Add Biquad Filter"}),Object(c.jsx)("li",{onClick:function(){return W("ChannelMerger")},children:"Add Channel Merger"}),Object(c.jsx)("li",{onClick:function(){return W("ChannelSplitter")},children:"Add Channel Splitter"}),Object(c.jsx)("li",{onClick:function(){return W("ConstantSource")},children:"Add Constant Source"}),Object(c.jsx)("li",{onClick:function(){return W("Delay")},children:"Add Delay"}),Object(c.jsx)("li",{onClick:function(){return W("Destination")},children:"Add Destination"}),Object(c.jsx)("li",{onClick:function(){return W("DynamicsCompressor")},children:"Add Dynamics Compressor"}),Object(c.jsx)("li",{onClick:function(){return W("Gain")},children:"Add Gain"}),Object(c.jsx)("li",{onClick:function(){return W("Oscillator")},children:"Add Oscillator"}),Object(c.jsx)("li",{onClick:function(){return W("OscillatorNote")},children:"Add Oscillator Note"}),Object(c.jsx)("li",{onClick:function(){return W("StereoPanner")},children:"Add Stereo Panner"}),Object(c.jsx)("li",{onClick:function(){return W("WaveShaper")},children:"Add Wave Shaper"})]})}))]})}var je=r.a.memo(de),fe={fontSize:12,height:"100%",resize:"none",width:"100%"},be={display:"flex",position:"absolute",right:"100%",top:-10,transform:"rotate(-90deg)",transformOrigin:"bottom right"},me=function(){return{id:Object(h.a)(),elements:[],transform:{x:0,y:0,zoom:1}}};var ve=function(e){var t=e.setProject,n=g().removeNodes,r=Object(a.useState)(!1),i=Object(u.a)(r,2),o=i[0],l=i[1],d=Object(s.k)((function(e){return e.elements})),f=Object(s.k)((function(e){return e.transform})),b=d.map((function(e){return Object(j.a)(Object(j.a)({},e),{},{__rf:void 0})})),m={x:f[0],y:f[1],zoom:f[2]},v=JSON.stringify({elements:b,transform:m}),O=Object(a.useMemo)((function(){return function(e){return{height:"100%",padding:10,position:"absolute",right:0,top:0,transform:e?"translateX(0)":"translateX(100%)",transition:"transform 0.4s ease",width:400}}(o)}),[o]);Object(a.useEffect)((function(){var e=atob(window.location.hash.substr(1));try{var n=JSON.parse(e),c=n.elements,a=n.transform;t({elements:c,id:Object(h.a)(),transform:a})}catch(r){console.error(r)}}),[t]),Object(a.useEffect)((function(){window.location.hash=btoa(v)}),[v]);var p=Object(a.useCallback)((function(e){try{var n=JSON.parse(e.target.value),c=n.elements,a=n.transform;t({elements:c,id:Object(h.a)(),transform:a})}catch(e){console.error(e)}}),[t]),x=Object(a.useCallback)((function(){n(),t(me)}),[n,t]),y=Object(a.useCallback)((function(){return l((function(e){return!e}))}),[]);return Object(c.jsxs)("div",{style:O,children:[Object(c.jsx)("textarea",{onChange:p,style:fe,value:JSON.stringify({elements:b,transform:m},null,2)}),Object(c.jsxs)("div",{style:be,children:[Object(c.jsx)("button",{onClick:x,style:{marginRight:10},children:"clear"}),Object(c.jsx)("button",{onClick:y,children:o?"hide":"show"})]})]})};var Oe=function(e){var t=e.children,n=Object(a.useRef)({}),r=Object(a.useMemo)((function(){return{addNode:function(e,t){n.current[e]=t},nodes:n.current,removeNode:function(e){delete n.current[e]},removeNodes:function(){var e=Object.keys(n.current).map((function(e){return n.current[e]}));e.forEach((function(e){var t,n;return null===(t=(n=e).stop)||void 0===t?void 0:t.call(n)})),e.forEach((function(e){return e.disconnect()})),n.current={}}}}),[]);return Object(c.jsx)("div",{children:Object(c.jsx)(x.Provider,{value:r,children:t})})};var he=function(){var e=Object(a.useState)(me),t=Object(u.a)(e,2),n=t[0],r=t[1];return Object(c.jsx)(d,{children:Object(c.jsx)(Oe,{children:Object(c.jsx)(s.e,{children:Object(c.jsxs)("div",{style:{alignItems:"stretch",display:"flex",height:"100vh"},children:[Object(c.jsx)(je,{elements:n.elements,transform:n.transform},n.id),Object(c.jsx)(ve,{setProject:r})]})})})})},pe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,36)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),r(e),i(e)}))};o.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(he,{})}),document.getElementById("root")),pe()}},[[29,1,2]]]);
//# sourceMappingURL=main.f4326428.chunk.js.map