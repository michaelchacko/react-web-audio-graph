(this["webpackJsonpreact-web-audio-graph"]=this["webpackJsonpreact-web-audio-graph"]||[]).push([[0],{25:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n(0),o=n.n(a),r=n(7),i=n.n(r),u=(n(25),n(3)),s=n(2),l=Object(a.createContext)(null);var d=function(e){var t=e.children,n=Object(a.useMemo)((function(){try{return window.AudioContext||(window.AudioContext=window.webkitAudioContext),new window.AudioContext}catch(e){}}),[]),o=Object(a.useCallback)((function(){"suspended"===(null===n||void 0===n?void 0:n.state)&&n.resume()}),[n]);return n?Object(c.jsx)("div",{onClick:o,children:Object(c.jsx)(l.Provider,{value:n,children:t})}):Object(c.jsx)("div",{children:"Sorry, but the Web Audio API is not supported by your browser."})},j=n(4),f=n(15),b=n(5),v=n.n(b),O=n(12),m=n(34),h=n(35),p=n(10),x=Object(a.createContext)(null);function g(){return Object(a.useContext)(x)}var y=n(16);var N=function(e){var t=e.dataGetter,n=e.node,o=e.paused,r=Object(y.a)(e,["dataGetter","node","paused"]),i=Object(a.useRef)(new Uint8Array(n.frequencyBinCount)),u=Object(a.useRef)(null),s=Object(a.useCallback)((function(){var e=u.current,n=null===e||void 0===e?void 0:e.getContext("2d");e&&n&&("getByteTimeDomainData"===t?function(e,t){var n=0,c=e.canvas.height,a=e.canvas.width,o=t.length,r=a/o;e.fillStyle="#001400",e.fillRect(0,0,a,256),e.lineWidth=2,e.strokeStyle="#00c800",e.beginPath(),e.moveTo(n,c-t[0]/128*c/2);for(var i=1;i<o;i++){var u=t[i]/128*c/2;e.lineTo(n,c-u),n+=r}e.stroke()}(n,i.current):"getByteFrequencyData"===t&&function(e,t){var n=0,c=e.canvas.height,a=e.canvas.width,o=t.length,r=a/o;e.fillStyle="#001400",e.fillRect(0,0,a,256),e.fillStyle="#00c800";for(var i=0;i<o;i++){var u=c*(t[i]/255),s=c-u;e.fillRect(n,s,r,u),n+=r}}(n,i.current))}),[t]),l=Object(a.useCallback)((function(){var e=n.frequencyBinCount,c=new Uint8Array(e);n[t].call(n,c),i.current=c}),[n,t]);return function(e,t){var n=Object(a.useRef)(),c=Object(a.useRef)(),o=null===t||void 0===t?void 0:t.maxFPS,r=Object(a.useCallback)((function(t){if(null!=n.current){var a=t-n.current;(!o||a>1e3/o)&&(e(a),n.current=t)}else e(0),n.current=t;c.current=requestAnimationFrame(r)}),[e]);Object(a.useEffect)((function(){return c.current=requestAnimationFrame(r),function(){null!=c.current&&cancelAnimationFrame(c.current)}}),[r])}(Object(a.useCallback)((function(){o||(l(),s())}),[s,l,o])),Object(c.jsx)("canvas",Object(j.a)({ref:u,style:{display:"block"}},r))};function C(e){var t=e.children,n=e.id,a=e.inputs,o=e.outputs,r=e.type;return Object(c.jsxs)("div",{className:"customNode",title:n,children:[Object(c.jsx)("div",{className:"customNode_header",children:r}),Object(c.jsxs)("div",{className:"customNode_body",children:[a&&Object(c.jsx)("div",{className:"customNode_inputs",children:a.map((function(e){return Object(c.jsxs)("div",{className:"customNode_item",children:[Object(c.jsx)(s.c,{id:e,position:s.d.Left,type:"target"}),e]},e)}))}),o&&Object(c.jsx)("div",{className:"customNode_outputs",children:o.map((function(e){return Object(c.jsxs)("div",{className:"customNode_item",children:[Object(c.jsx)(s.c,{id:e,position:s.d.Right,type:"source"}),e]},e)}))})]}),t]})}var w=o.a.memo(C),k=function(e){var t=e.data,n=e.id,o=e.selected,r=e.type;console.log("Analyser render",t,n,o);var i=t.dataGetter,u=void 0===i?"getByteTimeDomainData":i,s=t.fftSizeExp,d=void 0===s?11:s,j=t.onChange,f=t.paused,b=void 0!==f&&f,v=Object(a.useContext)(l),O=Object(a.useMemo)((function(){return v.createAnalyser()}),[v]),m=g().addNode;return Object(a.useEffect)((function(){m(n,O)}),[m,O,n]),Object(a.useEffect)((function(){O.fftSize=Math.pow(2,d)}),[O,d]),Object(c.jsxs)(w,{id:n,inputs:["input","fftSize"],outputs:["output"],type:r,children:[Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)(N,{dataGetter:u,node:O,paused:b,height:64,width:256})}),o&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsxs)("div",{className:"customNode_item",children:[Object(c.jsx)("input",{className:"nodrag",type:"range",max:"11",min:"5",onChange:function(e){return j({fftSizeExp:+e.target.value})},step:1,value:d}),Math.pow(2,d)]}),Object(c.jsxs)("div",{className:"customNode_item",style:{justifyContent:"space-between"},children:[Object(c.jsxs)("select",{onChange:function(e){return j({dataGetter:e.target.value})},value:u,children:[Object(c.jsx)("option",{value:"getByteFrequencyData",children:"Frequency"}),Object(c.jsx)("option",{value:"getByteTimeDomainData",children:"Time Domain"})]}),Object(c.jsxs)("label",{style:{alignItems:"center",display:"flex"},children:[Object(c.jsx)("input",{className:"nodrag",type:"checkbox",checked:b,onChange:function(e){return j({paused:!b})}}),"Paused"]})]})]})]})},E=function(e){var t=e.data,n=e.id,o=e.selected,r=e.type;console.log("BiquadFilter render",t,n,o);var i=t.detune,u=void 0===i?0:i,s=t.gain,d=void 0===s?0:s,j=t.frequency,f=void 0===j?350:j,b=t.Q,v=void 0===b?1:b,O=t.onChange,m=t.type,h=void 0===m?"lowpass":m,p=Object(a.useContext)(l),x=Object(a.useMemo)((function(){return p.createBiquadFilter()}),[p]),y=g().addNode;return Object(a.useEffect)((function(){y(n,x)}),[y,x,n]),Object(a.useEffect)((function(){x.detune.value=u}),[x,u]),Object(a.useEffect)((function(){x.frequency.value=f}),[x,f]),Object(a.useEffect)((function(){x.gain.value=d}),[x,d]),Object(a.useEffect)((function(){x.Q.value=v}),[x,v]),Object(a.useEffect)((function(){x.type=h}),[x,h]),Object(c.jsx)(w,{id:n,inputs:["input","detune","frequency","gain","Q"],outputs:["output"],type:r,children:o&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:-100,max:100,onChange:function(e){return O({detune:+e.target.value})},step:1,type:"range",value:u})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:0,max:22050,onChange:function(e){return O({frequency:+e.target.value})},type:"number",value:f})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:-40,max:40,onChange:function(e){return O({gain:+e.target.value})},step:.1,type:"range",value:d})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:1e-4,max:1e3,onChange:function(e){return O({Q:+e.target.value})},type:"number",value:v})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsxs)("select",{onChange:function(e){return O({type:e.target.value})},value:h,children:[Object(c.jsx)("option",{value:"lowpass",children:"lowpass"}),Object(c.jsx)("option",{value:"highpass",children:"highpass"}),Object(c.jsx)("option",{value:"bandpass",children:"bandpass"}),Object(c.jsx)("option",{value:"lowshelf",children:"lowshelf"}),Object(c.jsx)("option",{value:"highshelf",children:"highshelf"}),Object(c.jsx)("option",{value:"peaking",children:"peaking"}),Object(c.jsx)("option",{value:"notch",children:"notch"}),Object(c.jsx)("option",{value:"allpass",children:"allpass"})]})})]})})},_=function(e){var t=e.data,n=e.id,o=e.selected,r=e.type;console.log("ConstantSource render",t,n,o);var i=t.offset,u=void 0===i?1:i,s=t.onChange,d=Object(a.useContext)(l),j=Object(a.useMemo)((function(){return d.createConstantSource()}),[d]);Object(a.useEffect)((function(){return j.start(),function(){return j.stop()}}),[j]);var f=g().addNode;return Object(a.useEffect)((function(){f(n,j)}),[f,j,n]),Object(a.useEffect)((function(){return j.offset.value=u}),[j,u]),Object(c.jsx)(w,{id:n,outputs:["output"],type:r,children:o&&Object(c.jsx)("div",{className:"customNode_editor",children:Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"number",onChange:function(e){return s({offset:+e.target.value})},style:{width:"100%"},value:u})})})})},S=function(e){var t=e.data,n=e.id,o=e.selected,r=e.type;console.log("Delay render",t,n,o);var i=t.delayTime,u=void 0===i?1:i,s=t.onChange,d=Object(a.useContext)(l),j=Object(a.useMemo)((function(){return d.createDelay()}),[d]),f=g().addNode;return Object(a.useEffect)((function(){f(n,j)}),[f,j,n]),Object(a.useEffect)((function(){j.delayTime.value=u}),[j,u]),Object(c.jsx)(w,{id:n,inputs:["input","delayTime"],outputs:["output"],type:r,children:o&&Object(c.jsx)("div",{className:"customNode_editor",children:Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"number",onChange:function(e){return s({delayTime:+e.target.value})},value:u})})})})},A=function(e){var t=e.id,n=e.type,o=Object(a.useContext)(l).destination,r=g().addNode;return Object(a.useEffect)((function(){r(t,o)}),[r,o,t]),Object(c.jsx)(w,{id:t,inputs:["input"],type:n})},D=function(e){var t=e.data,n=e.id,o=e.selected,r=e.type;console.log("DynamicsCompressor render",t,n,o);var i=t.attack,u=void 0===i?.003:i,s=t.knee,d=void 0===s?30:s,j=t.onChange,f=t.ratio,b=void 0===f?12:f,v=t.release,O=void 0===v?.25:v,m=t.threshold,h=void 0===m?-24:m,p=Object(a.useContext)(l),x=Object(a.useMemo)((function(){return p.createDynamicsCompressor()}),[p]),y=g().addNode;return Object(a.useEffect)((function(){y(n,x)}),[y,x,n]),Object(a.useEffect)((function(){x.threshold.value=h}),[x,h]),Object(a.useEffect)((function(){x.knee.value=d}),[x,d]),Object(a.useEffect)((function(){x.ratio.value=b}),[x,b]),Object(a.useEffect)((function(){x.attack.value=u}),[x,u]),Object(a.useEffect)((function(){x.release.value=O}),[x,O]),Object(c.jsx)(w,{id:n,inputs:["input","threshold","knee","ratio","attack","release"],outputs:["output"],type:r,children:o&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"0",min:"-100",step:"1",onChange:function(e){return j({threshold:+e.target.value})},value:h})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"40",min:"0",step:"1",onChange:function(e){return j({knee:+e.target.value})},value:d})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"20",min:"1",step:"1",onChange:function(e){return j({ratio:+e.target.value})},value:b})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"1",min:"0",step:"0.001",onChange:function(e){return j({attack:+e.target.value})},value:u})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"1",min:"0",step:"0.001",onChange:function(e){return j({release:+e.target.value})},value:O})})]})})},F=function(e){var t=e.data,n=e.id,o=e.selected,r=e.type;console.log("Gain render",t,n,o);var i=t.gain,u=void 0===i?1:i,s=t.onChange,d=Object(a.useContext)(l),j=Object(a.useMemo)((function(){return d.createGain()}),[d]),f=g().addNode;return Object(a.useEffect)((function(){f(n,j)}),[f,j,n]),Object(a.useEffect)((function(){j.gain.value=u}),[j,u]),Object(c.jsx)(w,{id:n,inputs:["input","gain"],outputs:["output"],type:r,children:o&&Object(c.jsx)("div",{className:"customNode_editor",children:Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"1",min:"-1",step:"0.01",onChange:function(e){return s({gain:+e.target.value})},value:u})})})})},q=function(e){var t=e.data,n=e.id,o=e.selected,r=e.type;console.log("Oscillator render",t,n,o);var i=t.detune,u=void 0===i?0:i,s=t.frequency,d=void 0===s?440:s,j=t.onChange,f=t.type,b=void 0===f?"sine":f,v=Object(a.useContext)(l),O=Object(a.useMemo)((function(){return v.createOscillator()}),[v]);Object(a.useEffect)((function(){return O.start(),function(){return O.stop()}}),[O]);var m=g().addNode;return Object(a.useEffect)((function(){m(n,O)}),[m,O,n]),Object(a.useEffect)((function(){O.detune.value=null!==u&&void 0!==u?u:0}),[O,u]),Object(a.useEffect)((function(){O.frequency.value=null!==d&&void 0!==d?d:440}),[O,d]),Object(a.useEffect)((function(){O.type=null!==b&&void 0!==b?b:"sine"}),[O,b]),Object(c.jsx)(w,{id:n,inputs:["detune","frequency"],outputs:["output"],type:r,children:o&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:-100,max:100,onChange:function(e){return j({detune:+e.target.value})},step:1,type:"number",value:u})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:0,max:2e4,onChange:function(e){return j({frequency:+e.target.value})},type:"number",value:d})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsxs)("select",{onChange:function(e){return j({type:e.target.value})},value:b,children:[Object(c.jsx)("option",{value:"sawtooth",children:"sawtooth"}),Object(c.jsx)("option",{value:"square",children:"square"}),Object(c.jsx)("option",{value:"sine",children:"sine"}),Object(c.jsx)("option",{value:"triangle",children:"triangle"})]})})]})})},M=["C","C^#","D","D^#","E","F","F^#","G","G^#","A","A^#","B"];function P(e){if(e<0||e>10)throw new RangeError("Octave must be between 0 and 10, is ".concat(e))}function R(e){if(e<0||e>11)throw new RangeError("Octave must be between 0 and 11, is ".concat(e))}var B=function(e){var t=e.data,n=e.id,o=e.selected,r=e.type;console.log("OscillatorNote render",t,n,o);var i=t.detune,u=void 0===i?0:i,s=t.octave,d=void 0===s?4:s,j=t.onChange,f=t.twelfth,b=void 0===f?0:f,v=t.type,O=void 0===v?"sine":v,m=function(e,t){return P(e),R(t),16.35*Math.pow(2,e+t/12)}(d,b),h=function(e,t){return P(e),R(t),"".concat(M[t%12],"_").concat(e)}(d,b),p=Object(a.useContext)(l),x=Object(a.useMemo)((function(){return p.createOscillator()}),[p]);Object(a.useEffect)((function(){return x.start(),function(){return x.stop()}}),[x]);var y=g().addNode;return Object(a.useEffect)((function(){y(n,x)}),[y,x,n]),Object(a.useEffect)((function(){x.detune.value=null!==u&&void 0!==u?u:0}),[x,u]),Object(a.useEffect)((function(){x.frequency.value=m}),[x,m]),Object(a.useEffect)((function(){x.type=null!==O&&void 0!==O?O:"sine"}),[x,O]),Object(c.jsx)(w,{id:n,inputs:["detune"],outputs:["output"],type:r,children:o&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",min:-100,max:100,onChange:function(e){return j({detune:+e.target.value})},step:1,type:"number",value:u})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsxs)("div",{children:[Object(c.jsx)("button",{onClick:function(){return j({octave:(11+d-1)%11})},children:"-"}),Object(c.jsx)("button",{onClick:function(){return j({octave:(d+1)%11})},children:"+"}),"octave: ",d,Object(c.jsx)("br",{}),Object(c.jsx)("button",{onClick:function(){return j({twelfth:(12+b-1)%12})},children:"-"}),Object(c.jsx)("button",{onClick:function(){return j({twelfth:(b+1)%12})},children:"+"}),"twelfth:",b,Object(c.jsx)("br",{}),h," @ ",m.toFixed(2)," Hz"]})}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsxs)("select",{onChange:function(e){return j({type:e.target.value})},value:O,children:[Object(c.jsx)("option",{value:"sawtooth",children:"sawtooth"}),Object(c.jsx)("option",{value:"square",children:"square"}),Object(c.jsx)("option",{value:"sine",children:"sine"}),Object(c.jsx)("option",{value:"triangle",children:"triangle"})]})})]})})},T=function(e){var t=e.data,n=e.id,o=e.selected,r=e.type;console.log("StereoPanner render",t,n,o);var i=t.pan,u=void 0===i?0:i,s=t.onChange,d=Object(a.useContext)(l),j=Object(a.useMemo)((function(){return d.createStereoPanner()}),[d]),f=g().addNode;return Object(a.useEffect)((function(){f(n,j)}),[f,j,n]),Object(a.useEffect)((function(){j.pan.value=u}),[j,u]),Object(c.jsx)(w,{id:n,inputs:["input","pan"],outputs:["output"],type:r,children:o&&Object(c.jsx)("div",{className:"customNode_editor",children:Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsx)("input",{className:"nodrag",type:"range",max:"1",min:"-1",step:"0.01",onChange:function(e){return s({pan:+e.target.value})},value:u})})})})},G=function(e){var t,n=e.data,o=e.id,r=e.selected,i=e.type;console.log("WaveShaper render",n,o,r);var s=n.onChange,d=n.oversample,j=Object(a.useState)(null!==(t=n.curveFn)&&void 0!==t?t:"const k = 50;\nconst samples = curve.length;\nconst deg = Math.PI / 180;\nfor (let i = 0; i < samples; i++) {\n  const x = (i * 2) / samples - 1;\n  curve[i] = ((3 + k) * x * 20 * deg) / (Math.PI + k * Math.abs(x));\n}\nreturn curve;"),f=Object(u.a)(j,2),b=f[0],v=f[1],O=Object(a.useState)(b),m=Object(u.a)(O,2),h=m[0],p=m[1],x=Object(a.useContext)(l),y=Object(a.useMemo)((function(){return x.createWaveShaper()}),[x]),N=g().addNode;Object(a.useEffect)((function(){N(o,y)}),[N,y,o]);var C=Object(a.useMemo)((function(){var e=new Float32Array(x.sampleRate);return new Function("curve",h)(e)}),[x.sampleRate,h]);Object(a.useEffect)((function(){y.curve=C}),[y,C]),Object(a.useEffect)((function(){y.oversample=d}),[y,d]);var k=Object(a.useCallback)((function(){try{new Function("curve",b)(new Float32Array(x.sampleRate)),p(b),s({curveFn:b})}catch(e){console.error("bad fn")}}),[x.sampleRate,b,s]);return Object(c.jsx)(w,{id:o,inputs:["input"],outputs:["output"],type:i,children:r&&Object(c.jsxs)("div",{className:"customNode_editor",children:[Object(c.jsxs)("div",{className:"customNode_item",style:{flexWrap:"wrap"},children:[Object(c.jsx)("textarea",{className:"nodrag",onChange:function(e){return v(e.target.value)},rows:8,style:{width:"100%"},value:b}),Object(c.jsx)("button",{onClick:k,children:"save"})]}),Object(c.jsx)("div",{className:"customNode_item",children:Object(c.jsxs)("select",{onChange:function(e){return s({oversample:e.target.value})},value:d,children:[Object(c.jsx)("option",{value:"none",children:"none"}),Object(c.jsx)("option",{value:"2x",children:"2x"}),Object(c.jsx)("option",{value:"4x",children:"4x"})]})})]})})};var z={Analyser:o.a.memo(k),BiquadFilter:o.a.memo(E),ConstantSource:o.a.memo(_),Delay:o.a.memo(S),Destination:o.a.memo(A),DynamicsCompressor:o.a.memo(D),Gain:o.a.memo(F),Oscillator:o.a.memo(q),OscillatorNote:o.a.memo(B),StereoPanner:o.a.memo(T),WaveShaper:o.a.memo(G)};function I(e,t){return W.apply(this,arguments)}function W(){return(W=Object(O.a)(v.a.mark((function e(t,n){var c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=t.filter(s.h).reduce((function(e,t){return e[t.source]=!0,e[t.target]=!0,e}),{});case 1:if(!Object.keys(c).length){e.next=7;break}return Object.keys(n).forEach((function(e){delete c[e]})),e.next=5,new Promise((function(e){return setTimeout(e,0)}));case 5:e.next=1;break;case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e){var t=e.elements,n=o.a.useState(!1),r=Object(u.a)(n,2),i=r[0],l=r[1],d=o.a.useState(),b=Object(u.a)(d,2),x=b[0],y=b[1],N=o.a.useState(null),C=Object(u.a)(N,2),w=C[0],k=C[1],E=Object(m.a)(w,x,{placement:"bottom-start"}),_=E.styles,S=E.attributes,A=Object(s.k)((function(e){return e.transform})),D=Object(a.useState)(t),F=Object(u.a)(D,2),q=F[0],M=F[1],P=g().nodes,R=function(){var e=g().nodes;return Object(a.useCallback)((function(t){if(console.log("Connection created",t),t.source&&t.target&&t.targetHandle){var n=e[t.source],c=e[t.target],a=t.targetHandle;"input"===a?n.connect(c):(n.connect(c[a]),c[a].value=0)}}),[e])}(),B=function(){var e=g().nodes;return Object(a.useCallback)((function(t){if(console.log("Connection removed",t),t.source&&t.target&&t.targetHandle){var n=e[t.source],c=e[t.target],a=t.targetHandle;"input"===a?n.disconnect(c):(n.disconnect(c[a]),c[a].value=c[a].defaultValue)}}),[e])}(),T=function(){var e=g().nodes;return Object(a.useCallback)((function(t){console.log("Node removed",t,e);var n=e[t];n&&n.disconnect()}),[e])}(),G=function(e){return function(t){M(Object(p.a)((function(n){var c=n.filter(s.i).find((function(t){return t.id===e}));c&&Object.keys(t).forEach((function(e){return c.data[e]=t[e]}))})))}},W=function(){var e=Object(O.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M(Object(p.a)((function(e){e.filter(s.i).forEach((function(e){e.data.onChange=G(e.id)}))}))),e.next=3,I(t,P);case 3:t.filter(s.h).forEach((function(e){return R(e)}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=Object(a.useCallback)((function(e){e.filter(s.h).forEach((function(e){return B(e)})),e.filter(s.i).forEach((function(e){return T(e.id)})),M((function(t){return Object(s.j)(e,t)}))}),[B,T]),H=Object(a.useCallback)((function(e){var t="".concat(e,"-").concat(Object(h.a)()),n={id:t,data:{onChange:G(t)},type:e,position:{x:(w.getBoundingClientRect().left-A[0])/A[2],y:(w.getBoundingClientRect().top-A[1])/A[2]}};M((function(e){return[].concat(Object(f.a)(e),[n])})),l(!1)}),[A,w]);return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)(s.g,{elements:q,nodeTypes:z,onConnect:function(e){M((function(t){return Object(s.f)(e,t)})),R(e)},onEdgeUpdate:function(e,t){B(e),M((function(t){return Object(s.j)([e],t)})),M((function(e){return Object(s.f)(t,e)})),R(t)},onElementsRemove:J,onLoad:W,onNodeDragStop:function(e,t){M(Object(p.a)((function(e){var n=e.filter(s.i).find((function(e){return e.id===t.id}));n&&(n.position=t.position)})))},onPaneClick:function(e){l(!!(null===x||void 0===x?void 0:x.contains(e.target)))},onPaneContextMenu:function(e){e.preventDefault(),l(!0),k({getBoundingClientRect:function(){return{top:10*Math.floor(e.clientY/10),left:10*Math.floor(e.clientX/10),height:0,width:0}}})},onlyRenderVisibleElements:!1,snapToGrid:!0,snapGrid:[10,10],style:{zIndex:0},children:[Object(c.jsx)(s.a,{gap:10}),Object(c.jsx)(s.b,{})]}),i&&Object(c.jsx)("div",Object(j.a)(Object(j.a)({ref:function(e){return e&&y(e)},style:_.popper},S.popper),{},{children:Object(c.jsxs)("ul",{className:"contextMenu",children:[Object(c.jsx)("li",{onClick:function(){return H("Analyser")},children:"Add Analyser"}),Object(c.jsx)("li",{onClick:function(){return H("BiquadFilter")},children:"Add Biquad Filter"}),Object(c.jsx)("li",{onClick:function(){return H("ConstantSource")},children:"Add Constant Source"}),Object(c.jsx)("li",{onClick:function(){return H("Delay")},children:"Add Delay"}),Object(c.jsx)("li",{onClick:function(){return H("Destination")},children:"Add Destination"}),Object(c.jsx)("li",{onClick:function(){return H("DynamicsCompressor")},children:"Add Dynamics Compressor"}),Object(c.jsx)("li",{onClick:function(){return H("Gain")},children:"Add Gain"}),Object(c.jsx)("li",{onClick:function(){return H("Oscillator")},children:"Add Oscillator"}),Object(c.jsx)("li",{onClick:function(){return H("OscillatorNote")},children:"Add Oscillator Note"}),Object(c.jsx)("li",{onClick:function(){return H("StereoPanner")},children:"Add Stereo Panner"}),Object(c.jsx)("li",{onClick:function(){return H("WaveShaper")},children:"Add Wave Shaper"})]})}))]})}var H=o.a.memo(J);var L=function(e){var t=e.setProject,n=Object(s.k)((function(e){return e.elements})).map((function(e){return Object(j.a)(Object(j.a)({},e),{},{__rf:void 0})})),o=JSON.stringify(n);Object(a.useEffect)((function(){var e=atob(window.location.hash.substr(1));try{var n=JSON.parse(e);t({id:Object(h.a)(),elements:n})}catch(c){}}),[t]),Object(a.useEffect)((function(){window.location.hash=btoa(o)}),[o]);var r=Object(a.useCallback)((function(e){try{var n=JSON.parse(e.target.value);t({elements:n,id:Object(h.a)()})}catch(e){console.error(e)}}),[t]);return Object(c.jsx)("div",{style:{padding:10,width:400},children:Object(c.jsx)("textarea",{onChange:r,style:{fontSize:12,height:"100%",resize:"none",width:"100%"},value:JSON.stringify(n,null,2)})})};var Q=function(e){var t=e.children,n=Object(a.useRef)({}),o=Object(a.useMemo)((function(){return{addNode:function(e,t){n.current[e]=t},nodes:n.current}}),[]);return Object(c.jsx)("div",{children:Object(c.jsx)(x.Provider,{value:o,children:t})})};var U=function(){var e=Object(a.useState)({id:"",elements:[]}),t=Object(u.a)(e,2),n=t[0],o=t[1];return Object(c.jsx)(d,{children:Object(c.jsx)(Q,{children:Object(c.jsx)(s.e,{children:Object(c.jsxs)("div",{style:{alignItems:"stretch",display:"flex",height:"100vh"},children:[Object(c.jsx)(H,{elements:n.elements},n.id),Object(c.jsx)(L,{setProject:o})]})})})})},V=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,36)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),c(e),a(e),o(e),r(e)}))};i.a.render(Object(c.jsx)(o.a.StrictMode,{children:Object(c.jsx)(U,{})}),document.getElementById("root")),V()}},[[29,1,2]]]);
//# sourceMappingURL=main.609d0f85.chunk.js.map